<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>WildFly 18 / JBoss EAP 7.3 - EJBCA - Documentation Space</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>


<script type="text/javascript" src="assets/js/scroll-tree.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script>
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="108530570">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">EJBCADS</span>
                    <img class="space-logo" src="EJBCADS.png" />
                </h1>
                <a href="EJBCA_7.4.3.2_Documentation.html" class="ht-space-link">
                    <h2>EJBCA - Documentation Space</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=100270489"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="EJBCA_7.4.3.2_Documentation.html">EJBCA - Documentation Space</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="EJBCA_Documentation.html">EJBCA Documentation</a></li>
                                                                                                         <li class="shortcut"><a href="EJBCA_Installation.html">EJBCA Installation</a></li>
                                                                                     <li><a href="Application_Servers.html">Application Servers</a></li>
                                                            </ul>
</div>            <h1 id="src-100270489"> <span>WildFly 18 / JBoss EAP 7.3</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">

<p   
>Configure the application server according to instructions in the following sections.</p>
<p   
></p>
<ul class="toc-indentation "><li class=" "><p   
><a   href="#src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1Eb3dubG9hZGFuZEV4dHJhY3RXaWxkRmx5">Download and Extract WildFly</a></p>
</li><li class=" "><p   
><a   href="#src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1SZW1vdmVSRVNURWFzeS1DcnlwdG8">Remove RESTEasy-Crypto</a></p>
</li><li class=" "><p   
><a   href="#src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1Db25maWd1cmVXaWxkRmx5YXNhU2VydmljZQ">Configure WildFly as a Service</a></p>
</li><li class=" "><p   
><a   href="#src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1TdGFydFdpbGRGbHk">Start WildFly</a></p>
</li><li class=" "><p   
><a   href="#src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1DcmVhdGVhbkVseXRyb25DcmVkZW50aWFsU3RvcmU">Create an Elytron Credential Store</a></p>
</li><li class=" "><p   
><a   href="#src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1BZGREYXRhYmFzZURyaXZlcg">Add Database Driver</a></p>
</li><li class=" "><p   
><a   href="#src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1BZGREYXRhc291cmNl">Add Datasource</a></p>
</li><li class=" "><p   
><a   href="#src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1Db25maWd1cmVXaWxkRmx5UmVtb3Rpbmc">Configure WildFly Remoting</a></p>
</li><li class=" "><p   
><a   href="#src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1Db25maWd1cmVMb2dnaW5n">Configure Logging</a></p>
</li><li class=" "><p   
><a   href="#src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1IVFRQKFMpTGlzdGVuZXJDb25maWd1cmF0aW9ud2l0aDMtcG9ydFNlcGFyYXRpb24">HTTP(S) Listener Configuration with 3-port Separation</a></p>
</li><li class=" "><p   
><a   href="#src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1IVFRQUHJvdG9jb2xCZWhhdmlvckNvbmZpZ3VyYXRpb24">HTTP Protocol Behavior Configuration</a></p>
</li><li class=" "><p   
><a   href="#src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1PcHRpb25hbENvbmZpZ3VyYXRpb24">Optional Configuration</a></p>
</li><li class=" "><p   
><a   href="#src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1QZXJmb3JtYW5jZVR1bmluZw">Performance Tuning</a></p>
</li><li class=" "><p   
><a   href="#src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1DbGVhckNvbW1hbmRMaW5lSGlzdG9yeQ">Clear Command Line History</a></p>
</li><li class=" "><p   
><a   href="#src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1DcmVhdGVhU25hcHNob3RvZnRoZUNvbmZpZ3VyYXRpb24">Create a Snapshot of the Configuration</a></p>
</li><li class=" "><p   
><a   href="#src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1OZXh0U3RlcDpEZXBsb3lpbmdFSkJDQQ">Next Step: Deploying EJBCA</a></p>
</li></ul>    <div class="section section-1" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1Eb3dubG9hZGFuZEV4dHJhY3RXaWxkRmx5">
        <h1 class="heading "><span>Download and Extract WildFly</span></h1>
<p   
>If you have not downloaded WildFly already, you can use the following command to do so:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">wget https:</code><code class="plain">//download</code><code class="plain">.jboss.org</code><code class="plain">/wildfly/18</code><code class="plain">.0.0.Final</code><code class="plain">/wildfly-18</code><code class="plain">.0.0.Final.zip -O </code><code class="plain">/tmp/wildfly-18</code><code class="plain">.0.0.Final.zip</code></div>
<div class="line"><code class="plain">unzip -q </code><code class="plain">/tmp/wildfly-18</code><code class="plain">.0.0.Final.zip -d </code><code class="plain">/opt/</code></div>
<div class="line"><code class="functions">ln</code><code class="plain"> -snf </code><code class="plain">/opt/wildfly-18</code><code class="plain">.0.0.Final </code><code class="plain">/opt/wildfly</code></div>
</div>
    </div>
<p   
>If you are using JBoss EAP 7.3, you can download it from <a  class="external-link" href="https://developers.redhat.com/products/eap/download">Red Hat's website</a>.</p>
    </div>
    <div class="section section-1" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1SZW1vdmVSRVNURWFzeS1DcnlwdG8">
        <h1 class="heading label"><span>Remove RESTEasy-Crypto</span></h1>
<p   
>The application server can sometimes load its own version of Bouncy Castle, resulting in incompatibility and/or conflict issues.</p>
<p   
>A typical error occurring as a consequence of the wrong Bouncy Castle being loaded in EJBCA is:</p>
    <blockquote>
<p   
>ClassCastException setting BagAttributes, can not set friendly name: : java.lang.ClassCastException: org.bouncycastle.jcajce.provider.asymmetric.x509.X509CertificateObject cannot be cast to org.bouncycastle.jce.interfaces.PKCS12BagAttributeCarrier</p>
        </blockquote>
<p   
>To avoid issues and prevent Wildfly/JBoss from loading the Bouncy Castle library included in the RESTEasy-Crypto module rather than the library included in EJBCA, run the following:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">sed -i </code><code class="string">'s|.*org.jboss.resteasy.resteasy-crypto.*||'</code><code class="plain"> /opt/wildfly/modules/system/layers/base/org/jboss/as/jaxrs/main/module.xml</code></div>
<div class="line"><code class="plain">rm -rf /opt/wildfly/modules/system/layers/base/org/jboss/resteasy/resteasy-crypto</code></div>
</div>
    </div>
<p   
>The following displays an example log message in case of a conflict:</p>
    <blockquote>
<p   
>ERROR [StartupSingletonBean] BouncyCastle is not loaded by an EJBCA classloader, version conflict is likely</p>
        </blockquote>
<p   
>Create a Custom Configuration</p>
<p   
>Replace <tt class=" ">/opt/wildfly/bin/standalone.conf</tt> with the following configuration file.</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                    <div class="title">/opt/wildfly/bin/standalone.conf</div>
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-title="/opt/wildfly/bin/standalone.conf" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">if</code><code class="plain"> [ </code><code class="string">"x$JBOSS_MODULES_SYSTEM_PKGS"</code><code class="plain"> = </code><code class="string">"x"</code><code class="plain"> ]; </code><code class="keyword">then</code></div>
<div class="line"><code class="plain">   JBOSS_MODULES_SYSTEM_PKGS=</code><code class="string">"org.jboss.byteman"</code></div>
<div class="line"><code class="keyword">fi</code></div>
<div class="line"> </div>
<div class="line"><code class="keyword">if</code><code class="plain"> [ </code><code class="string">"x$JAVA_OPTS"</code><code class="plain"> = </code><code class="string">"x"</code><code class="plain"> ]; </code><code class="keyword">then</code></div>
<div class="line"><code class="plain">   JAVA_OPTS=</code><code class="string">"-Xms&lt;HEAP_SIZE&gt;m -Xmx&lt;HEAP_SIZE&gt;m -XX:MetaspaceSize=96M -XX:MaxMetaspaceSize=256m"</code></div>
<div class="line"><code class="plain">   JAVA_OPTS=</code><code class="string">"$JAVA_OPTS -Djava.net.preferIPv4Stack=true"</code></div>
<div class="line"><code class="plain">   JAVA_OPTS=</code><code class="string">"$JAVA_OPTS -Djboss.modules.system.pkgs=$JBOSS_MODULES_SYSTEM_PKGS"</code></div>
<div class="line"><code class="plain">   JAVA_OPTS=</code><code class="string">"$JAVA_OPTS -Djava.awt.headless=true"</code></div>
<div class="line"><code class="plain">   JAVA_OPTS=</code><code class="string">"$JAVA_OPTS -Djboss.tx.node.id=&lt;TX_NODE_ID&gt;"</code></div>
<div class="line"><code class="plain">   JAVA_OPTS=</code><code class="string">"$JAVA_OPTS -Djdk.tls.ephemeralDHKeySize=2048"</code></div>
<div class="line"><code class="keyword">else</code></div>
<div class="line"><code class="plain">   </code><code class="functions">echo</code><code class="plain"> </code><code class="string">"JAVA_OPTS already set in environment; overriding default settings with values: $JAVA_OPTS"</code></div>
<div class="line"><code class="keyword">fi</code></div>
</div>
    </div>
    <div class="section section-2" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1TZXRBbGxvd2VkTWVtb3J5VXNhZ2U">
        <h2 class="heading "><span>Set Allowed Memory Usage</span></h2>
<p   
>By default, 512 MB of heap (RAM) is allowed to be used by the application server. This is not sufficient to run EJBCA and it is recommended to allocate at least 2048 MB of RAM. To increase the default value, run the following command:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="functions">sed</code><code class="plain"> -i -e </code><code class="string">'s/&lt;HEAP_SIZE&gt;/2048/g'</code><code class="plain"> </code><code class="plain">/opt/wildfly/bin/standalone</code><code class="plain">.conf</code></div>
</div>
    </div>
    </div>
    <div class="section section-2" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1TZXRUcmFuc2FjdGlvbk5vZGVJZA">
        <h2 class="heading "><span>Set Transaction Node Id</span></h2>
<p   
>Set the transaction node ID to a unique value.</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="functions">sed</code><code class="plain"> -i -e </code><code class="string">"s/&lt;TX_NODE_ID&gt;/$(od -A n -t d -N 1 /dev/urandom | tr -d ' ')/g"</code><code class="plain"> </code><code class="plain">/opt/wildfly/bin/standalone</code><code class="plain">.conf</code></div>
</div>
    </div>
    </div>
    </div>
    <div class="section section-1" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1Db25maWd1cmVXaWxkRmx5YXNhU2VydmljZQ">
        <h1 class="heading "><span>Configure WildFly as a Service</span></h1>
<p   
>Modern Linux systems use systemd to start and stop services. The WildFly package already contains the necessary files to run as a service, but they need to be installed manually. Once started as a service, WildFly will run as the <tt class=" ">wildfly</tt> user, and you need to add this user as well.</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="functions">cp</code><code class="plain"> </code><code class="plain">/opt/wildfly/docs/contrib/scripts/systemd/launch</code><code class="plain">.sh </code><code class="plain">/opt/wildfly/bin</code></div>
<div class="line"><code class="functions">cp</code><code class="plain"> </code><code class="plain">/opt/wildfly/docs/contrib/scripts/systemd/wildfly</code><code class="plain">.service </code><code class="plain">/etc/systemd/system</code></div>
<div class="line"><code class="functions">mkdir</code><code class="plain"> </code><code class="plain">/etc/wildfly</code></div>
<div class="line"><code class="functions">cp</code><code class="plain"> </code><code class="plain">/opt/wildfly/docs/contrib/scripts/systemd/wildfly</code><code class="plain">.conf </code><code class="plain">/etc/wildfly</code></div>
<div class="line"><code class="plain">systemctl daemon-reload</code></div>
<div class="line"><code class="functions">useradd</code><code class="plain"> -M wildfly</code></div>
<div class="line"><code class="functions">chown</code><code class="plain"> -R wildfly:wildfly </code><code class="plain">/opt/wildfly-18</code><code class="plain">.0.0.Final/</code></div>
</div>
    </div>
    </div>
    <div class="section section-1" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1TdGFydFdpbGRGbHk">
        <h1 class="heading "><span>Start WildFly</span></h1>
<p   
>Start WildFly as a service.</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">systemctl start wildfly</code></div>
</div>
    </div>
    </div>
    <div class="section section-1" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1DcmVhdGVhbkVseXRyb25DcmVkZW50aWFsU3RvcmU">
        <h1 class="heading "><span>Create an Elytron Credential Store</span></h1>
<p   
>You can protect passwords by storing them in a credential store. The credential is encrypted with a master password which is fetched by WildFly on startup.</p>
    <div class="section section-2" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1DcmVhdGVhTWFzdGVyUGFzc3dvcmQ">
        <h2 class="heading "><span>Create a Master Password</span></h2>
<p   
>Create a script which outputs the master password to <tt class=" ">stdout</tt> and ensure the script can only be executed by the <tt class=" ">wildfly</tt> user.</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="functions">echo</code><code class="plain"> </code><code class="string">'#!/bin/sh'</code><code class="plain"> &gt; </code><code class="plain">/usr/bin/wildfly_pass</code></div>
<div class="line"><code class="functions">echo</code><code class="plain"> </code><code class="string">"echo '$(openssl rand -base64 24)'"</code><code class="plain"> &gt;&gt; </code><code class="plain">/usr/bin/wildfly_pass</code></div>
<div class="line"><code class="functions">chown</code><code class="plain"> wildfly:wildfly </code><code class="plain">/usr/bin/wildfly_pass</code></div>
<div class="line"><code class="functions">chmod</code><code class="plain"> 700 </code><code class="plain">/usr/bin/wildfly_pass</code></div>
</div>
    </div>
    </div>
    <div class="section section-2" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1DcmVhdGV0aGVDcmVkZW50aWFsU3RvcmU">
        <h2 class="heading "><span>Create the Credential Store</span></h2>
<p   
>Create a credential store in<tt class=" "> /opt/wildfly/standalone/configuration</tt> encrypted with the password echoed by the<tt class=" "> wildfly_pass</tt> script.</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=elytron/credential-store=defaultCS:add(location=credentials, relative-to=jboss.server.config.dir, credential-reference={clear-text="{EXT}/usr/bin/wildfly_pass", type="COMMAND"}, create=true)'</code></div>
</div>
    </div>
    </div>
    </div>
    <div class="section section-1" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1BZGREYXRhYmFzZURyaXZlcg">
        <h1 class="heading "><span>Add Database Driver</span></h1>
<p   
>For MariaDB and PostgreSQL, the database driver can be added by hot-deploying it into the deployment directory. This will be picked up by WildFly and deployed so you can create a data source straight away. You can use a generic name, without version number, to get a generic <tt class=" ">driver-name</tt> for the data source command.</p>
<p   
>Example command for MariaDB:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">wget https:</code><code class="plain">//downloads</code><code class="plain">.mariadb.com</code><code class="plain">/Connectors/java/latest/mariadb-java-client-2</code><code class="plain">.3.0.jar -O </code><code class="plain">/opt/wildfly/standalone/deployments/mariadb-java-client</code><code class="plain">.jar</code></div>
</div>
    </div>
<p   
>Example command for PostgreSQL:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">wget https:</code><code class="comments">//jdbc.postgresql.org/download/postgresql-42.2.9.jar -O /opt/wildfly/standalone/deployments/postgresql.jar</code></div>
</div>
    </div>
<p   
>If you are using another type of database, copy the JDBC driver to the deployment directory and make note of the driver class and driver-name shown in the server log, for later use when adding the data source. For example:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">... INFO  [org.jboss.as.connector.deployers.jdbc] (...) WFLYJCA0005: Deploying non-JDBC-compliant driver class org.postgresql.Driver (version 42.2.5)</code></div>
<div class="line"><code class="plain">... INFO  [org.jboss.as.connector.deployers.jdbc] (...) WFLYJCA0018: Started Driver service with driver-name = postgresql-jdbc3.jar</code></div>
</div>
    </div>
    </div>
    <div class="section section-1" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1BZGREYXRhc291cmNl">
        <h1 class="heading "><span>Add Datasource</span></h1>
<p   
>    <span style="color: #000000;">
To add a data source for EJBCA to use, run the commands in JBoss CLI according to the examples below.    </span>
</p>
    <div  class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>    <span style="color: #000000;">
Note that <tt class=" ">--driver-name</tt> is should be the same as the filename of the JAR file you copied in the step above. The <tt class=" ">--jndi-name</tt> is is defined by the property <tt class=" ">datasource.jndi-name</tt> in <tt class=" ">database.properties</tt>, and the default value is used in the following example. The <tt class=" ">--user-name</tt> and <tt class=" ">--password</tt> defines the username and password of the EJBCA database user. They correspond to the username and password defined by the properties <tt class=" ">database.username</tt> and <tt class=" ">database.password</tt> in <tt class=" ">database.properties</tt>. In production, this password should be changed to a &quot;real&quot; password.    </span>
</p>
        </div>
    </div>
    <div class="section section-2" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1NYXJpYURCTWFyaWFEQg">
        <h2 class="heading "><span>MariaDB</span></h2>
<p   
>    <span style="color: #000000;">
For MariaDB, run the following:    </span>
</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect '/subsystem=elytron/credential-store=defaultCS:add-alias(alias=dbPassword, secret-value="ejbca")'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect 'data-source add --name=ejbcads --driver-name="mariadb-java-client.jar" --connection-url="jdbc:</code><code class="comments">mysql://127.0.0.1:3306/ejbca</code><code class="plain">" --jndi-name="java:/EjbcaDS" --use-ccm=true --driver-class="org.mariadb.jdbc.Driver" --user-name="ejbca" --credential-reference={store=defaultCS, alias=dbPassword} --validate-on-match=true --background-validation=false --prepared-statements-cache-size=50 --share-prepared-statements=true --min-pool-size=5 --max-pool-size=150 --pool-prefill=true --transaction-isolation=TRANSACTION_READ_COMMITTED --check-valid-connection-sql="select 1;"'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect ':reload'</code></div>
</div>
    </div>
<p   
>    <span style="color: #000000;">
<img  class="emoticon emoticon-warning"  src="images/s/-98b7og/8401/7d0034e810b0e95b8c0694abfaf748cf5135c15a/_/images/icons/emoticons/warning.svg" alt="images/s/-98b7og/8401/7d0034e810b0e95b8c0694abfaf748cf5135c15a/_/images/icons/emoticons/warning.svg"   />
 Wait for the reload to complete by checking the server log or the result of <strong class=" "><tt class=" ">:read-attribute(name=server-state)</tt></strong> before continuing.    </span>
</p>
    </div>
    <div class="section section-2" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1Qb3N0Z3JlU1FMUG9zdGdyZVNRTA">
        <h2 class="heading "><span>PostgreSQL </span></h2>
<p   
>    <span style="color: #000000;">
For PostgreSQL, run the following:    </span>
</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/subsystem=elytron/credential-store=defaultCS:add-alias(alias=dbPassword, secret-value="foo123")'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'data-source add --name=ejbcads --driver-name="org.postgresql.Driver" --connection-url="jdbc:postgresql://127.0.0.1/ejbca" --jndi-name="java:/EjbcaDS" --use-ccm=true --driver-name="postgresql.jar" --driver-class="org.postgresql.Driver" --user-name="ejbca" --credential-reference={store=defaultCS, alias=dbPassword} --validate-on-match=true --background-validation=false --prepared-statements-cache-size=50 --share-prepared-statements=true --min-pool-size=5 --max-pool-size=150 --pool-prefill=true --transaction-isolation=TRANSACTION_READ_COMMITTED --check-valid-connection-sql="select 1;"'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">':reload'</code></div>
</div>
    </div>
<p   
>    <span style="color: #003366;">
<img  class="emoticon emoticon-warning"  src="images/s/-98b7og/8401/7d0034e810b0e95b8c0694abfaf748cf5135c15a/_/images/icons/emoticons/warning.svg" alt="images/s/-98b7og/8401/7d0034e810b0e95b8c0694abfaf748cf5135c15a/_/images/icons/emoticons/warning.svg"   />
    <span style="color: #000000;">
 Wait for the reload to complete by checking the server log or the result of <strong class=" "><tt class=" ">:read-attribute(name=server-state)</tt></strong> before continuing.    </span>
    </span>
</p>
    </div>
    <div class="section section-2" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1PdGhlckRhdGFiYXNlcw">
        <h2 class="heading "><span>Other Databases</span></h2>
<p   
>    <span style="color: #000000;">
If you are using another type of database, adapt the statement above with the correct <tt class=" ">--driver-name</tt>, <tt class=" ">--connection-url,</tt> <tt class=" ">--driver-class</tt> and <tt class=" ">--check-valid-connection-sql</tt>.    </span>
</p>
    </div>
    </div>
    <div class="section section-1" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1Db25maWd1cmVXaWxkRmx5UmVtb3Rpbmc">
        <h1 class="heading "><span>Configure WildFly Remoting</span></h1>
<p   
>    <span style="color: #000000;">
EJBCA needs to use JBoss Remoting for the EJBCA CLI to work. Configure it to use a separate port 4447 and remove any other dependency on remoting except for what EJBCA needs.    </span>
</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=remoting/http-connector=http-remoting-connector:write-attribute(name=connector-ref,value=remoting)'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/socket-binding-group=standard-sockets/socket-binding=remoting:add(port=4447,interface=management)'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=undertow/server=default-server/http-listener=remoting:add(socket-binding=remoting,enable-http2=true)'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">':reload'</code></div>
</div>
    </div>
<p   
>    <span style="color: #003366;">
<img  class="emoticon emoticon-warning"  src="images/s/-98b7og/8401/7d0034e810b0e95b8c0694abfaf748cf5135c15a/_/images/icons/emoticons/warning.svg" alt="images/s/-98b7og/8401/7d0034e810b0e95b8c0694abfaf748cf5135c15a/_/images/icons/emoticons/warning.svg"   />
     <span style="color: #000000;">
Wait for the reload to complete by checking the server log or the result of <strong class=" "><tt class=" ">:read-attribute(name=server-state)</tt></strong> before continuing.    </span>
    </span>
</p>
    </div>
    <div class="section section-1" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1Db25maWd1cmVMb2dnaW5n">
        <h1 class="heading "><span>Configure Logging</span></h1>
<p   
>    <span style="color: #000000;">
Configure logging in JBoss to be able to dynamically change logging. For production systems, INFO log level is recommended:    </span>
</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=logging/logger=org.ejbca:add(level=INFO)'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=logging/logger=org.cesecore:add(level=INFO)'</code></div>
</div>
    </div>
<p  class="auto-cursor-target" 
>    <span style="color: #000000;">
To later enable DEBUG log level, if needed, use the following:    </span>
</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=logging/logger=org.ejbca:write-attribute(name=level, value=DEBUG)'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=logging/logger=org.cesecore:write-attribute(name=level, value=DEBUG)'</code></div>
</div>
    </div>
    <div class="section section-2" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1BZGRpdGlvbmFsTG9nZ2luZ0NvbmZpZ3VyYXRpb24">
        <h2 class="heading "><span>Additional Logging Configuration</span></h2>
<p   
>    <span style="color: #000000;">
You may additionally want to add the following configuration:    </span>
</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=logging/logger=org.jboss:add(level=WARN)'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=logging/logger=org.cesecore.config.ConfigurationHolder:add(level=WARN)'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=logging/logger=org.hibernate.dialect.H2Dialect:add(level=ERROR)'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=logging/logger=org.wildfly:add(level=WARN)'</code></div>
</div>
    </div>
    </div>
    <div class="section section-2" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1SZW1vdmVPbGRMb2dGaWxlcw">
        <h2 class="heading "><span>Remove Old Log Files</span></h2>
<p   
>    <span style="color: #000000;">
Log files are rotated daily by default, but old log files are not deleted automatically. You can delete old log files using a cronjob:    </span>
</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                    <div class="title">/etc/cron.daily/wildfly</div>
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-title="/etc/cron.daily/wildfly" data-linenumbers="true" data-firstline="1">
<div class="line"><code class="comments">#!/bin/sh</code></div>
<div class="line"><code class="comments"># Remove log files older than 7 days</code></div>
<div class="line"><code class="functions">find</code><code class="plain"> </code><code class="plain">/opt/wildfly/standalone/log/</code><code class="plain"> -</code><code class="functions">type</code><code class="plain"> f -mtime +7 -name </code><code class="string">'server.log*'</code><code class="plain"> -execdir </code><code class="functions">rm</code><code class="plain"> -- </code><code class="string">'{}'</code><code class="plain"> \;</code></div>
</div>
    </div>
<p   
>    <span style="color: #000000;">
Make the file executable:    </span>
</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">chmod +x /etc/cron.daily/wildfly</code></div>
</div>
    </div>
    </div>
    </div>
    <div class="section section-1" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1IVFRQKFMpTGlzdGVuZXJDb25maWd1cmF0aW9ud2l0aDMtcG9ydFNlcGFyYXRpb24">
        <h1 class="heading "><span>HTTP(S) Listener Configuration with 3-port Separation</span></h1>
<p   
>    <span style="color: #000000;">
The following section explains how to set up Undertow with 3-port separation. Port 8080 is used for HTTP (unencrypted traffic), port 8442 for HTTPS (encrypted) traffic without only server authentication and port 8443 for HTTP with both server and client authentication.    </span>
</p>
    <div class="section section-2" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1SZW1vdmVFeGlzdGluZ1RMU2FuZEhUVFBDb25maWd1cmF0aW9u">
        <h2 class="heading "><span>Remove Existing TLS and HTTP Configuration</span></h2>
<p   
>    <span style="color: #000000;">
Run the following commands in JBoss CLI to remove existing TLS and HTTP configuration (just to be safe):    </span>
</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/subsystem=undertow/server=default-server/http-listener=default:remove()'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/subsystem=undertow/server=default-server/https-listener=https:remove()'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/socket-binding-group=standard-sockets/socket-binding=http:remove()'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/socket-binding-group=standard-sockets/socket-binding=https:remove()'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">':reload'</code></div>
</div>
    </div>
<p   
>    <span style="color: #003366;">
<img  class="emoticon emoticon-warning"  src="images/s/-98b7og/8401/7d0034e810b0e95b8c0694abfaf748cf5135c15a/_/images/icons/emoticons/warning.svg" alt="images/s/-98b7og/8401/7d0034e810b0e95b8c0694abfaf748cf5135c15a/_/images/icons/emoticons/warning.svg"   />
     <span style="color: #000000;">
Wait for the reload to complete by checking the server log or the result of <strong class=" "><tt class=" ">:read-attribute(name=server-state)</tt></strong> before continuing.    </span>
    </span>
</p>
    </div>
    <div class="section section-2" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1BZGROZXdJbnRlcmZhY2VzYW5kU29ja2V0cw">
        <h2 class="heading "><span>Add New Interfaces and Sockets</span></h2>
<p   
>    <span style="color: #000000;">
To add new interfaces and sockets, use the following:    </span>
</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/interface=http:add(inet-address="0.0.0.0")'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/interface=httpspub:add(inet-address="0.0.0.0")'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/interface=httpspriv:add(inet-address="0.0.0.0")'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/socket-binding-group=standard-sockets/socket-binding=http:add(port="8080",interface="http")'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/socket-binding-group=standard-sockets/socket-binding=httpspub:add(port="8442",interface="httpspub")'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/socket-binding-group=standard-sockets/socket-binding=httpspriv:add(port="8443",interface="httpspriv")'</code></div>
</div>
    </div>
    </div>
    <div class="section section-2" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1Db25maWd1cmVUTFM">
        <h2 class="heading "><span>Configure TLS</span></h2>
<p   
>    <span style="color: #000000;">
Configure TLS according to the following instructions. Update the keystore password for <tt class=" ">keystore.jks</tt> to match <tt class=" ">httpsserver.password</tt> and the truststore password for <tt class=" ">truststore.jks</tt> to match <tt class=" ">java.truststore</tt> in <tt class=" ">web.properties</tt>.    </span>
</p>
    <div  class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>    <span style="color: #000000;">
Make sure the password of the keystore and truststore in this section are correct, in order for the commands not to fail. In production, the passwords should be changed to &quot;real&quot; passwords.    </span>
</p>
        </div>
    </div>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=elytron/credential-store=defaultCS:add-alias(alias=httpsKeystorePassword, secret-value="serverpwd")'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=elytron/credential-store=defaultCS:add-alias(alias=httpsTruststorePassword, secret-value="changeit")'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=elytron/key-store=httpsKS:add(path="keystore/keystore.jks",relative-to=jboss.server.config.dir,credential-reference={store=defaultCS, alias=httpsKeystorePassword},type=JKS)'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=elytron/key-store=httpsTS:add(path="keystore/truststore.jks",relative-to=jboss.server.config.dir,credential-reference={store=defaultCS, alias=httpsTruststorePassword},type=JKS)'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=elytron/key-manager=httpsKM:add(key-store=httpsKS,algorithm="SunX509",credential-reference={store=defaultCS, alias=httpsKeystorePassword})'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=elytron/trust-manager=httpsTM:add(key-store=httpsTS)'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=elytron/server-ssl-context=httpspub:add(key-manager=httpsKM,protocols=["TLSv1.2"],use-cipher-suites-order=false,cipher-suite-filter="TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256")'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=elytron/server-ssl-context=httpspriv:add(key-manager=httpsKM,protocols=["TLSv1.2"],use-cipher-suites-order=false,cipher-suite-filter="TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256",trust-manager=httpsTM,need-client-auth=true)'</code></div>
</div>
    </div>
    </div>
    <div class="section section-2" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1BZGRIVFRQKFMpTGlzdGVuZXJz">
        <h2 class="heading label"><span>Add HTTP(S) Listeners</span></h2>
<p  class="label" 
>    <span style="color: #000000;">
To add HTTP(S) listeners:    </span>
</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=undertow/server=default-server/http-listener=http:add(socket-binding="http", redirect-socket="httpspriv")'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=undertow/server=default-server/https-listener=httpspub:add(socket-binding="httpspub", ssl-context="httpspub", max-parameters=2048)'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=undertow/server=default-server/https-listener=httpspriv:add(socket-binding="httpspriv", ssl-context="httpspriv", max-parameters=2048)'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">':reload'</code></div>
</div>
    </div>
<p  class="subsubsection" 
>    <span style="color: #000000;">
<img  class="emoticon emoticon-warning"  src="images/s/-98b7og/8401/7d0034e810b0e95b8c0694abfaf748cf5135c15a/_/images/icons/emoticons/warning.svg" alt="images/s/-98b7og/8401/7d0034e810b0e95b8c0694abfaf748cf5135c15a/_/images/icons/emoticons/warning.svg"   />
 Wait for the reload to complete by checking the server log or the result of <strong class=" "><tt class=" ">:read-attribute(name=server-state)</tt></strong> before continuing.    </span>
</p>
    </div>
    </div>
    <div class="section section-1" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1IVFRQUHJvdG9jb2xCZWhhdmlvckNvbmZpZ3VyYXRpb24">
        <h1 class="heading label"><span>HTTP Protocol Behavior Configuration</span></h1>
<p   
>    <span style="color: #000000;">
The following shows an example HTTP Protocol Behavior Configuration.<br/>    </span>
</p>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>    <span style="color: #000000;">
If you are using OCSP GET requests, setting URI encoding and allowing encoding for query and backslash are needed.    </span>
</p>
<p   
>    <span style="color: #000000;">
The commands below ensure the address in the EJBCA WS WSDL matches the hostname and port the client uses to access the server.    </span>
</p>
        </div>
    </div>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/system-property=org.apache.catalina.connector.URI_ENCODING:add(value="UTF-8")'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/system-property=org.apache.catalina.connector.USE_BODY_ENCODING_FOR_QUERY_STRING:add(value=true)'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/system-property=org.apache.tomcat.util.buf.UDecoder.ALLOW_ENCODED_SLASH:add(value=true)'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/system-property=org.apache.tomcat.util.http.Parameters.MAX_COUNT:add(value=2048)'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/system-property=org.apache.catalina.connector.CoyoteAdapter.ALLOW_BACKSLASH:add(value=true)'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=webservices:write-attribute(name=wsdl-host, value=jbossws.undefined.host)'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=webservices:write-attribute(name=modify-wsdl-address, value=true)'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">':reload'</code></div>
</div>
    </div>
<p   
>    <span style="color: #003366;">
<img  class="emoticon emoticon-warning"  src="images/s/-98b7og/8401/7d0034e810b0e95b8c0694abfaf748cf5135c15a/_/images/icons/emoticons/warning.svg" alt="images/s/-98b7og/8401/7d0034e810b0e95b8c0694abfaf748cf5135c15a/_/images/icons/emoticons/warning.svg"   />
     <span style="color: #000000;">
Wait for the reload to complete by checking the server log or the result of <strong class=" "><tt class=" ">:read-attribute(name=server-state)</tt></strong> before continuing.    </span>
<br/>    </span>
</p>
    </div>
    <div class="section section-1" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1PcHRpb25hbENvbmZpZ3VyYXRpb24">
        <h1 class="heading label"><span>Optional Configuration</span></h1>
<p   
>    <span style="color: #000000;">
The following sections cover optional configurations.    </span>
</p>
    <div class="section section-2" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1SZW1vdmVXZWxjb21lQ29udGVudA">
        <h2 class="heading label"><span>Remove Welcome Content</span></h2>
<p  class="label" 
>    <span style="color: #000000;">
Removes the hardcoded welcome page in WildFly.    </span>
</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=undertow/server=default-server/host=default-host/location="\/":remove()'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=undertow/configuration=handler/file=welcome-content:remove()'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">':reload'</code></div>
</div>
    </div>
<p  class="subsubsection" 
>    <span style="color: #003366;">
<img  class="emoticon emoticon-warning"  src="images/s/-98b7og/8401/7d0034e810b0e95b8c0694abfaf748cf5135c15a/_/images/icons/emoticons/warning.svg" alt="images/s/-98b7og/8401/7d0034e810b0e95b8c0694abfaf748cf5135c15a/_/images/icons/emoticons/warning.svg"   />
    <span style="color: #000000;">
 Wait for the reload to complete by checking the server log or the result of <strong class=" "><tt class=" ">:read-attribute(name=server-state)</tt></strong> before continuing.    </span>
    </span>
</p>
<p  class="subsubsection" 
>    <span style="color: #000000;">
You can also remove the actual files and save some disk space with:    </span>
</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">rm -rf /opt/wildfly/welcome-content/</code></div>
</div>
    </div>
    </div>
    <div class="section section-2" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1SZWRpcmVjdHRvQXBwbGljYXRpb25mb3JVbmtub3duVVJMcw">
        <h2 class="heading label"><span>Redirect to Application for Unknown URLs</span></h2>
<p   
>    <span style="color: #000000;">
Known URLs for EJBCA starts with <tt class=" ">/ejbca/, /crls, /certificates</tt> or <tt class=" ">/.well-known/</tt> (EST and ACME) according to the following example:    </span>
</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=undertow/configuration=filter/rewrite=redirect-to-app:add(redirect=true,target="/ejbca/")'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=undertow/server=default-server/host=default-host/filter-ref=redirect-to-app:add(predicate="method(GET) and not path-prefix(/ejbca,/crls,/certificates,/.well-known) and not equals({\%{LOCAL_PORT}, 4447})")'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">':reload'</code></div>
</div>
    </div>
<p  class="subsubsection" 
>    <span style="color: #000000;">
<img  class="emoticon emoticon-warning"  src="images/s/-98b7og/8401/7d0034e810b0e95b8c0694abfaf748cf5135c15a/_/images/icons/emoticons/warning.svg" alt="images/s/-98b7og/8401/7d0034e810b0e95b8c0694abfaf748cf5135c15a/_/images/icons/emoticons/warning.svg"   />
 Wait for the reload to complete by checking the server log or the result of <strong class=" "><tt class=" ">:read-attribute(name=server-state)</tt></strong> before continuing.    </span>
</p>
    </div>
    <div class="section section-2" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1VUkxSZXdyaXRpbmdmb3J0aGVDUkxTZXJ2bGV0">
        <h2 class="heading label"><span>URL Rewriting for the CRL Servlet</span></h2>
<p   
>    <span style="color: #000000;">
Since EJBCA 7.2, the ability to customize the URL for the CRL store servlet has been removed. For more information, see <a  class="external-link" href="https://jira.primekey.se/browse/ECA-7059">ECA-7059</a> and the <a   href="EJBCA_7.2_Upgrade_Notes.html">EJBCA 7.2 Upgrade Notes</a>.    </span>
</p>
<p   
>    <span style="color: #003366;">
    <span style="color: #000000;">
However, you can download CRLs on a different URL by adding a    </span>
     <span style="color: #000000;">
rewrite rule in Undertow, see     </span>
    </span>
    <span style="color: #000000;">
<a  class="external-link" href="https://wildscribe.github.io/JBoss%20EAP/7.2/subsystem/undertow/configuration/filter/rewrite/index.html">JBoss EAP 7.2 Model Reference</a>.     </span>
    <span style="color: #003366;">
    <span style="color: #000000;">
As an example, to allow a client to download CRLs from the URL <tt class=" ">/ejbca/crls/</tt> instead of<tt class=" "> /ejbca/publicweb/crls/</tt>, add the following configuration:    </span>
    </span>
</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=undertow/configuration=filter/rewrite=crl-rewrite:add(target="/ejbca/publicweb/crls/$${1}")'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=undertow/server=default-server/host=default-host/filter-ref=crl-rewrite:add(predicate="method(GET) and regex(\'/crls/(.*)\')")'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">':reload'</code></div>
</div>
    </div>
<p  class="subsubsection" 
>    <span style="color: #003366;">
<img  class="emoticon emoticon-warning"  src="images/s/-98b7og/8401/7d0034e810b0e95b8c0694abfaf748cf5135c15a/_/images/icons/emoticons/warning.svg" alt="images/s/-98b7og/8401/7d0034e810b0e95b8c0694abfaf748cf5135c15a/_/images/icons/emoticons/warning.svg"   />
     <span style="color: #000000;">
Wait for the reload to complete by checking the server log or the result of <strong class=" "><tt class=" ">:read-attribute(name=server-state)</tt></strong> before continuing.    </span>
    </span>
</p>
    </div>
    <div class="section section-2" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1FbmFibGVPQ1NQUmV2b2NhdGlvbkNoZWNraW5n">
        <h2 class="heading label"><span>Enable OCSP Revocation Checking</span></h2>
<p   
>    <span style="color: #000000;">
WildFly can check the validity of client certificates against the OCSP responder defined by the certificate's AIA extension:    </span>
</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=elytron/trust-manager=httpsTM:write-attribute(name=ocsp, value={})'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">':reload'</code></div>
</div>
    </div>
<p  class="label" 
>    <span style="color: #003366;">
<img  class="emoticon emoticon-warning"  src="images/s/-98b7og/8401/7d0034e810b0e95b8c0694abfaf748cf5135c15a/_/images/icons/emoticons/warning.svg" alt="images/s/-98b7og/8401/7d0034e810b0e95b8c0694abfaf748cf5135c15a/_/images/icons/emoticons/warning.svg"   />
     <span style="color: #000000;">
Wait for the reload to complete by checking the server log or the result of <strong class=" "><tt class=" ">:read-attribute(name=server-state)</tt></strong> before continuing.    </span>
    </span>
</p>
    </div>
    <div class="section section-2" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1SZW1vdmV0aGVFeGFtcGxlRFNEYXRhU291cmNl">
        <h2 class="heading label"><span>Remove the ExampleDS Data Source</span></h2>
<p   
>    <span style="color: #000000;">
To optionally remove the ExampleDS data source:    </span>
</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/subsystem=ee/service=default-bindings:remove()'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'data-source remove --name=ExampleDS'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">':reload'</code></div>
</div>
    </div>
<p  class="subsubsection" 
>    <span style="color: #000000;">
<img  class="emoticon emoticon-warning"  src="images/s/-98b7og/8401/7d0034e810b0e95b8c0694abfaf748cf5135c15a/_/images/icons/emoticons/warning.svg" alt="images/s/-98b7og/8401/7d0034e810b0e95b8c0694abfaf748cf5135c15a/_/images/icons/emoticons/warning.svg"   />
 Wait for the reload to complete by checking the server log or the result of <strong class=" "><tt class=" ">:read-attribute(name=server-state)</tt></strong> before continuing.    </span>
</p>
    </div>
    <div class="section section-2" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1SZW1vdmVVbm5lZWRlZFN1YnN5c3RlbXNhbmRFeHRlbnNpb25z">
        <h2 class="heading label"><span>Remove Unneeded Subsystems and Extensions</span></h2>
<p   
>    <span style="color: #000000;">
To optionally remove the unneeded subsystems and extensions:    </span>
</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/subsystem=jdr:remove()'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/subsystem=sar:remove()'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/subsystem=jmx:remove()'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/subsystem=pojo:remove()'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/subsystem=ee-security:remove()'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/subsystem=microprofile-metrics-smallrye:remove()'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/subsystem=microprofile-health-smallrye:remove()'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/subsystem=microprofile-opentracing-smallrye:remove()'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/extension=org.wildfly.extension.microprofile.health-smallrye:remove()'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/extension=org.wildfly.extension.microprofile.opentracing-smallrye:remove()'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/extension=org.jboss.as.jdr:remove()'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/extension=org.jboss.as.jmx:remove()'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/extension=org.jboss.as.sar:remove()'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/extension=org.jboss.as.pojo:remove()'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/extension=org.wildfly.extension.ee-security:remove()'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/subsystem=distributable-web:remove()'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/subsystem=infinispan/cache-container=ejb:remove()'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/subsystem=infinispan/cache-container=server:remove()'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/subsystem=ejb3/cache=distributable:remove()'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/subsystem=ejb3/passivation-store=infinispan:remove()'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/subsystem=security/security-domain=jaspitest:remove()'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/subsystem=datasources/jdbc-driver=h2:remove()'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">':reload'</code></div>
</div>
    </div>
<p  class="subsubsection" 
>    <span style="color: #003366;">
<img  class="emoticon emoticon-warning"  src="images/s/-98b7og/8401/7d0034e810b0e95b8c0694abfaf748cf5135c15a/_/images/icons/emoticons/warning.svg" alt="images/s/-98b7og/8401/7d0034e810b0e95b8c0694abfaf748cf5135c15a/_/images/icons/emoticons/warning.svg"   />
     <span style="color: #000000;">
Wait for the reload to complete by checking the server log or the result of <strong class=" "><tt class=" ">:read-attribute(name=server-state)</tt></strong> before continuing.    </span>
    </span>
</p>
    </div>
    <div class="section section-2" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1FbmFibGVBSlBDb25uZWN0b3I">
        <h2 class="heading label"><span>Enable AJP Connector</span></h2>
<p  class="label" 
>    <span style="color: #000000;">
Enabling the AJP connector is only needed if you terminate the TLS connection at a proxy (such as Apache or nginx) running in front of WildFly:    </span>
</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=undertow/server=default-server/ajp-listener=ajp-listener:add(socket-binding=ajp, scheme=https, enabled=true)'</code></div>
</div>
    </div>
    </div>
    <div class="section section-2" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1BZGRTdXBwb3J0Zm9yU2VuZGluZ0VtYWls">
        <h2 class="heading "><span>Add Support for Sending Email</span></h2>
<p   
>    <span style="color: #000000;">
To add support for sending email (SMTP), configure EjbcaMail. Specify the hostname, port, address and SMTP credentials according to the following example:    </span>
</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=elytron/credential-store=defaultCS:add-alias(alias=smtpPassword, secret-value="foo123")'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/socket-binding-group=standard-sockets/remote-destination-outbound-socket-binding=ejbca-mail-smtp:add(port="993", host="my.mail.server")'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=mail/mail-session="java:/EjbcaMail":add(jndi-name=java:/EjbcaMail, from=noreply@mymail)'</code><code class="plain"> </code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=mail/mail-session="java:/EjbcaMail"/server=smtp:add(outbound-socket-binding-ref=ejbca-mail-smtp, tls=true, username=smtpuser, credential-reference={store=defaultCS, alias=smtpPassword})'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">':reload'</code></div>
</div>
    </div>
    </div>
    <div class="section section-2" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1Pbmx5RGVwbG95YXRTdGFydHVw">
        <h2 class="heading "><span>Only Deploy at Startup</span></h2>
<p   
>    <span style="color: #000000;">
Historically, application servers are really bad at cleaning up memory from previous deployments and hot (re-)deploy is discouraged in production. To avoid manual deployment with the management interface, you can specify that the deployment directory should be scanned once at application server startup by setting the scan-interval to 0. This also prevents an attacker from loading a malicious JAR file by dropping it in the <tt class=" ">deployments</tt> directory.    </span>
</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=deployment-scanner/scanner=default:write-attribute(name=scan-interval,value=0)'</code></div>
</div>
    </div>
    </div>
    <div class="section section-2" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1JbmNyZWFzZURlcGxveW1lbnRUaW1lb3V0">
        <h2 class="heading subsubsection"><span>Increase Deployment Timeout</span></h2>
<p   
>    <span style="color: #000000;">
If you are using HSMs with smart card authentication or if the database needs to reindex when WildFly boots, you may have to increase the deployment timeout to be able to deploy EJBCA correctly. The deployment timeout is specified in seconds, the command below sets it to 5 minutes.    </span>
</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=deployment-scanner/scanner=default:write-attribute(name=deployment-timeout,value=300)'</code></div>
</div>
    </div>
    </div>
    <div class="section section-2" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1EaXNhYmxlTWFuYWdlbWVudFdlYkNvbnNvbGU">
        <h2 class="heading subsubsection"><span>Disable Management Web Console</span></h2>
<p   
>    <span style="color: #000000;">
If you only plan on using the JBoss CLI anyway there is little reason to keep this around.    </span>
</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/core-service=management/management-interface=http-interface:write-attribute(name=console-enabled,value=false)'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">':reload'</code></div>
</div>
    </div>
<p   
>    <span style="color: #000000;">
<img  class="emoticon emoticon-warning"  src="images/s/-98b7og/8401/7d0034e810b0e95b8c0694abfaf748cf5135c15a/_/images/icons/emoticons/warning.svg" alt="images/s/-98b7og/8401/7d0034e810b0e95b8c0694abfaf748cf5135c15a/_/images/icons/emoticons/warning.svg"   />
 Wait for the reload to complete by checking the server log or the result of <strong class=" "><tt class=" ">:read-attribute(name=server-state)</tt></strong> before continuing.    </span>
</p>
    </div>
    <div class="section section-2" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1JbmNyZWFzZU1heGltdW1VcGxvYWRTaXpl">
        <h2 class="heading "><span>Increase Maximum Upload Size</span></h2>
<p   
>    <span style="color: #000000;">
Increase the maximum size of POST requests to 25 MB. This may be needed if you need to upload large domain blacklists, zip packages with profiles, statedumps ect.    </span>
</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">'/subsystem=undertow/server=default-server/http-listener=http/:write-attribute(name=max-post-size,value=25485760)'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">':reload'</code></div>
</div>
    </div>
    </div>
    <div class="section section-2" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1FbmFibGVXaWxkRmx5QXVkaXRMb2dnaW5n">
        <h2 class="heading "><span>Enable WildFly Audit Logging</span></h2>
<p   
>    <span style="color: #000000;">
WildFly can audit log changes made to the management model and output audit log events in JSON format to the file <tt class=" ">/opt/wildfly/standalone/data/audit-log.log</tt>. Audit logging is disabled by default. To enable it, run:    </span>
</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/core-service=management/access=audit/logger=audit-log:write-attribute(name=enabled,value=true)'</code></div>
</div>
    </div>
    </div>
    <div class="section section-2" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1Db25maWd1cmVPQ1NQTG9nZ2luZw">
        <h2 class="heading "><span>Configure OCSP Logging</span></h2>
<p   
>If you have deployed<a   href="OCSP_Management.html"> EJBCA with the OCSP audit log, or OCSP transaction log enabled</a>, you should configure an asynchronous logger in WildFly for best performance.</p>
<p   
>For the OCSP transaction log:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/subsystem=logging/logger=org.cesecore.certificates.ocsp.logging.TransactionLogger:add(use-parent-handlers=</code><code class="keyword">false</code><code class="plain">)</code></div>
<div class="line"><code class="plain">/subsystem=logging/logger=org.cesecore.certificates.ocsp.logging.TransactionLogger:write-attribute(name=level, value=DEBUG)</code></div>
<div class="line"><code class="plain">/subsystem=logging/async-handler=ocsp-tx-async:add(queue-length=</code><code class="string">"100"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">/subsystem=logging/async-handler=ocsp-tx-async:write-attribute(name=level, value=DEBUG)</code></div>
<div class="line"><code class="plain">/subsystem=logging/async-handler=ocsp-tx-async:write-attribute(name=</code><code class="string">"overflow-action"</code><code class="plain">, value=</code><code class="string">"BLOCK"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">/subsystem=logging/logger=org.cesecore.certificates.ocsp.logging.TransactionLogger:add-handler(name=ocsp-tx-async)</code></div>
<div class="line"><code class="plain">/subsystem=logging/periodic-size-rotating-file-handler=ocsp-tx:add(autoflush=</code><code class="keyword">true</code><code class="plain">, append=</code><code class="keyword">true</code><code class="plain">, rotate-size=</code><code class="value">100000000</code><code class="plain">, max-backup-index=</code><code class="value">1</code><code class="plain">, suffix=</code><code class="string">".yyyy-MM-dd"</code><code class="plain">, file={path=ocsp-tx.log,relative-to=jboss.server.log.dir})</code></div>
<div class="line"><code class="plain">/subsystem=logging/async-handler=ocsp-tx-async:add-handler(name=ocsp-tx)</code></div>
</div>
    </div>
<p   
>For the OCSP audit log:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/subsystem=logging/logger=org.cesecore.certificates.ocsp.logging.AuditLogger:add(use-parent-handlers=</code><code class="keyword">false</code><code class="plain">)</code></div>
<div class="line"><code class="plain">/subsystem=logging/logger=org.cesecore.certificates.ocsp.logging.AuditLogger:write-attribute(name=level, value=DEBUG)</code></div>
<div class="line"><code class="plain">/subsystem=logging/async-handler=ocsp-audit-async:add(queue-length=</code><code class="string">"100"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">/subsystem=logging/async-handler=ocsp-audit-async:write-attribute(name=level, value=DEBUG)</code></div>
<div class="line"><code class="plain">/subsystem=logging/async-handler=ocsp-audit-async:write-attribute(name=</code><code class="string">"overflow-action"</code><code class="plain">, value=</code><code class="string">"BLOCK"</code><code class="plain">)</code></div>
<div class="line"><code class="plain">/subsystem=logging/logger=org.cesecore.certificates.ocsp.logging.AuditLogger-handler(name=ocsp-audit-async)</code></div>
<div class="line"><code class="plain">/subsystem=logging/periodic-size-rotating-file-handler=ocsp-audit:add(autoflush=</code><code class="keyword">true</code><code class="plain">, append=</code><code class="keyword">true</code><code class="plain">, rotate-size=</code><code class="value">100000000</code><code class="plain">, max-backup-index=</code><code class="value">1</code><code class="plain">, suffix=</code><code class="string">".yyyy-MM-dd"</code><code class="plain">, file={path=ocsp-audit.log,relative-to=jboss.server.log.dir})</code></div>
<div class="line"><code class="plain">/subsystem=logging/async-handler=ocsp-audit-async:add-handler(name=ocsp-audit)</code></div>
</div>
    </div>
    </div>
    <div class="section section-2" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1BQ01FRW5yb2xsbWVudA">
        <h2 class="heading "><span>ACME Enrollment</span></h2>
<p   
>WildFly can enroll for TLS certificates using ACME. If you enroll from EJBCA, see the <a   href="ACME.html">EJBCA documentation on how to enable and configure ACME</a>.</p>
<ol class=" "><li class=" "><p   
>If you are enrolling against your internal PKI, make sure it is trusted by Java.</p>
    <div  class="confbox admonition admonition-warning">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>Replace &lt;ROOT_NAME&gt; with the name of your root CA and<tt class=" "> &lt;ROOT_CA_PATH&gt;</tt> with the path to the root CA certificate in PEM format. The location of your <tt class=" ">cacerts</tt> file (<tt class=" ">/usr/lib/jvm/java-11-openjdk-amd64/lib/security/cacerts</tt>) may vary.</p>
        </div>
    </div>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">sudo keytool -importcert -noprompt -trustcacerts -alias &lt;ROOT_NAME&gt; -file &lt;ROOT_CA_PATH&gt; -keystore /usr/lib/jvm/java-</code><code class="value">11</code><code class="plain">-openjdk-amd64/lib/security/cacerts -storepass changeit</code></div>
</div>
    </div>
</li><li class=" "><p   
>Create a keystore where the keyspair of the ACME account will be stored.</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/subsystem=elytron/credential-store=defaultCS:add-alias(alias=accountsPassword, secret-value="foo123")'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/subsystem=elytron/key-store=accountsKS:add(path=accounts.jks,relative-to=jboss.server.config.dir,credential-reference={store=defaultCS, alias=accountsPassword},type=JKS)'</code></div>
</div>
    </div>
</li><li class=" "><p   
>Define the ACME directory to use.</p>
    <div  class="confbox admonition admonition-warning">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>Replace <tt class=" ">&lt;ACME_DIRECTORY_URL&gt;</tt> and <tt class=" ">&lt;ACME_DIRECTORY_URL_STAGING&gt;</tt> with the ACME directory URL for production and staging respectively. If you are enrolling directly against an EJBCA server, use something like <tt class=" ">https://hostname:8442/ejbca/acme/directory</tt>.</p>
        </div>
    </div>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/subsystem=elytron/certificate-authority=AcmeCA:add(url="&lt;ACME_DIRECTORY_URL&gt;",staging-url="&lt;ACME_DIRECTORY_URL_STAGING&gt;")'</code></div>
</div>
    </div>
</li><li class=" "><p   
>Register an ACME account with the CA.</p>
    <div  class="confbox admonition admonition-warning">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>Replace <tt class=" ">&lt;HOSTNAME&gt;</tt> with the hostname of your machine and <tt class=" ">&lt;EMAIL&gt;</tt> with your email address.</p>
        </div>
    </div>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/subsystem=elytron/certificate-authority-account=AcmeAccount:add(certificate-authority=AcmeCA,alias=&lt;HOSTNAME&gt;,key-store=accountsKS,contact-urls=[mailto:&lt;EMAIL&gt;])'</code></div>
</div>
    </div>
</li><li class=" "><p   
>Enroll for a certificate.</p>
    <div  class="confbox admonition admonition-warning">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>Replace <tt class=" ">&lt;HOSTNAME&gt;</tt> with the hostname of your machine.</p>
        </div>
    </div>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/subsystem=elytron/key-store=httpsKS:obtain-certificate(alias=&lt;HOSTNAME&gt;,domain-names=[&lt;HOSTNAME&gt;],certificate-authority-account=AcmeAccount,agree-to-terms-of-service)'</code></div>
</div>
    </div>
</li></ol>    </div>
    </div>
    <div class="section section-1" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1QZXJmb3JtYW5jZVR1bmluZw">
        <h1 class="heading "><span>Performance Tuning</span></h1>
<p   
>    <span style="color: #000000;">
The following section covers WildFly configuration for maximising EJBCA performance. The best setup could vary from installation to installation and should be manually fine-tuned. However, the &quot;default&quot; configuration would typically be a good starting point. You should also consider increasing the heap (RAM) for EJBCA instances under high load to something like 4 GB.    </span>
</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/subsystem=io/worker=default/:write-attribute(name=task-core-threads,value=25)'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/subsystem=io/worker=default/:write-attribute(name=task-max-threads,value=100)'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/subsystem=io/worker=default/:write-attribute(name=io-threads,value=100)'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/subsystem=ejb3/strict-max-bean-instance-pool=slsb-strict-max-pool:undefine-attribute(name=derive-size)'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/subsystem=ejb3/strict-max-bean-instance-pool=slsb-strict-max-pool:write-attribute(name=max-pool-size, value=32)'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">'/subsystem=datasources/data-source=ejbcads/:write-attribute(name=max-pool-size,value=150)'</code></div>
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli.sh --connect </code><code class="string">':reload'</code></div>
</div>
    </div>
<p   
>    <span style="color: #003366;">
<img  class="emoticon emoticon-warning"  src="images/s/-98b7og/8401/7d0034e810b0e95b8c0694abfaf748cf5135c15a/_/images/icons/emoticons/warning.svg" alt="images/s/-98b7og/8401/7d0034e810b0e95b8c0694abfaf748cf5135c15a/_/images/icons/emoticons/warning.svg"   />
     <span style="color: #000000;">
Wait for the reload to complete by checking the server log or the result of <strong class=" "><tt class=" ">:read-attribute(name=server-state)</tt></strong> before continuing.    </span>
    </span>
</p>
    </div>
    <div class="section section-1" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1DbGVhckNvbW1hbmRMaW5lSGlzdG9yeQ">
        <h1 class="heading "><span>Clear Command Line History</span></h1>
<p   
>    <span style="color: #000000;">
Clear the command line history to prevent accidental viewing of passwords put into the credential store.    </span>
</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="functions">history</code><code class="plain"> -c</code></div>
</div>
    </div>
    </div>
    <div class="section section-1" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1DcmVhdGVhU25hcHNob3RvZnRoZUNvbmZpZ3VyYXRpb24">
        <h1 class="heading "><span>Create a Snapshot of the Configuration</span></h1>
<p   
>    <span style="color: #000000;">
Create a snapshot of the current configuration to make sure you can revert back to a working state.    </span>
</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">/opt/wildfly/bin/jboss-cli</code><code class="plain">.sh --connect </code><code class="string">':take-snapshot'</code></div>
</div>
    </div>
    </div>
    <div class="section section-1" id="src-100270489_safe-id-aWQtLldpbGRGbHkxOC9KQm9zc0VBUDcuM3Y3LjQuMy1OZXh0U3RlcDpEZXBsb3lpbmdFSkJDQQ">
        <h1 class="heading "><span>Next Step: Deploying EJBCA</span></h1>
<p   
>    <span style="color: #003366;">
    <span style="color: #000000;">
For instructions on how to build and deploy EJBCA, see    </span>
 <a   href="Deploying_EJBCA.html">Deploying EJBCA.</a>    </span>
</p>
    </div>
        </div>

    </article>


            <nav id="ht-post-nav">
                <a href="WildFly_14___JBoss_EAP_7.2.html" class="ht-post-nav-prev">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-prev" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>WildFly 14 / JBoss EAP 7.2</span>
        </a>
                <a href="Deploying_EJBCA.html" class="ht-post-nav-next">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-next" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Deploying EJBCA</span>
        </a>
    </nav>    
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>
</body>
</html>
