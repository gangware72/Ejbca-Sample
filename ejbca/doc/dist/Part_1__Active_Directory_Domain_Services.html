<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Part 1: Active Directory Domain Services - EJBCA - Documentation Space</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>


<script type="text/javascript" src="assets/js/scroll-tree.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script>
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="108530570">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">EJBCADS</span>
                    <img class="space-logo" src="EJBCADS.png" />
                </h1>
                <a href="EJBCA_7.4.3.2_Documentation.html" class="ht-space-link">
                    <h2>EJBCA - Documentation Space</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=85924668"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="EJBCA_7.4.3.2_Documentation.html">EJBCA - Documentation Space</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="EJBCA_Documentation.html">EJBCA Documentation</a></li>
                                                                                                         <li class="shortcut"><a href="EJBCA_Integration.html">EJBCA Integration</a></li>
                                                                                                         <li class="shortcut"><a href="Integrating_with_Third-Party_Applications.html">Integrating with Third-Party Applications</a></li>
                                                                                     <li><a href="Auto_Enrollment_Configuration_Guide.html">Auto Enrollment Configuration Guide</a></li>
                                                            </ul>
</div>            <h1 id="src-85924668"> <span>Part 1: Active Directory Domain Services</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">

<p   
>    <span style="color: #172b4d;">
    <span style="color: #000000;">
The following sections cover administrating Active Directory Domain Services and include instructions on how to i    </span>
    </span>
nstall and configure Active Directory Domain Services, create service accounts, and add hosts to the DNS service:</p>
<ul class=" "><li class=" "><p   
>    <span style="color: #000000;">
<a   href="#src-85924668_safe-id-aWQtLlBhcnQxOkFjdGl2ZURpcmVjdG9yeURvbWFpblNlcnZpY2VzdjcuNC4wLVN0ZXAxLUluc3RhbGxBY3RpdmVEaXJlY3RvcnlEb21haW5TZXJ2aWNlcw">Step 1 - Install Active Directory Domain Services</a>    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
<a   href="#src-85924668_safe-id-aWQtLlBhcnQxOkFjdGl2ZURpcmVjdG9yeURvbWFpblNlcnZpY2VzdjcuNC4wLVN0ZXAyLUNyZWF0ZVNlcnZpY2VBY2NvdW50cw">Step 2 - Create Service Accounts</a>    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
<a   href="#src-85924668_safe-id-aWQtLlBhcnQxOkFjdGl2ZURpcmVjdG9yeURvbWFpblNlcnZpY2VzdjcuNC4wLVN0ZXAzLUFkZEhvc3RzdG9ETlNTZXJ2aWNl">Step 3 - Add Hosts to DNS Service</a>    </span>
</p>
</li></ul><p   
>    <span style="color: #000000;">
In the examples below, the     <span style="color: #172b4d;">
Active Directory Domain Services hostname    </span>
 is <strong class=" ">dsserver.yourcompany.com</strong>. The text enclosed in angle brackets should be replaced with names in your environment.    </span>
</p>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p  class="auto-cursor-target" 
>    <span style="color: #172b4d;">
The following highlights the possibility of using multiple services accounts for each service utilized, such as the Certificate Enrollment Services, the Tomcat Servlet, and an Active Directory Bind Account, and separating these pieces onto individual hosts. This method of installation can make the installation very complex from a permissions perspective and is only recommended for advanced users or if you have a very specific need to do it this way. A more straightforward method to install the servlet is to create a single service account and install the PrimeKey Auto Enrollment Servlet on the same host as the Windows Certificate Server host. This can reduce the communication between hosts and simplify the deployment complexity.    </span>
</p>
        </div>
    </div>
    <div class="section section-1" id="src-85924668_safe-id-aWQtLlBhcnQxOkFjdGl2ZURpcmVjdG9yeURvbWFpblNlcnZpY2VzdjcuNC4wLVN0ZXAxLUluc3RhbGxBY3RpdmVEaXJlY3RvcnlEb21haW5TZXJ2aWNlcw">
        <h1 class="heading "><span>Step 1 - Install Active Directory Domain Services</span></h1>
<p   
>    <span style="color: #000000;">
The following covers how to install the Active Directory Domain Services.    </span>
</p>
<p   
>    <span style="color: #000000;">
If an Active Directory environment already exists, continue to <a   href="#src-85924668_safe-id-aWQtLlBhcnQxOkFjdGl2ZURpcmVjdG9yeURvbWFpblNlcnZpY2VzdjcuNC4wLVN0ZXAyLUNyZWF0ZVNlcnZpY2VBY2NvdW50cw">Step 2 - Create Service Accounts</a> to create service accounts.    </span>
</p>
    <div class="section section-2" id="src-85924668_safe-id-aWQtLlBhcnQxOkFjdGl2ZURpcmVjdG9yeURvbWFpblNlcnZpY2VzdjcuNC4wLUluc3RhbGxBY3RpdmVEaXJlY3RvcnlEb21haW5TZXJ2aWNlcw">
        <h2 class="heading "><span>Install Active Directory Domain Services</span></h2>
<p   
>    <span style="color: #000000;">
To install Active Directory Domain Services:    </span>
</p>
<ol class=" "><li class=" "><p   
>    <span style="color: #000000;">
Assign a static IP address for this host.    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
Give the Host an appropriate computer name, in this example &lt;<strong class=" ">dsserver</strong>&gt;.<strong class=" "><br/></strong>    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
Open the Server Manager, click <strong class=" ">Add roles and features</strong>, and then click <strong class=" ">Next</strong>.    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
Select <strong class=" ">Role-based or feature-based installation</strong> and then click <strong class=" ">Next</strong>.    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
Select <strong class=" ">Select a server from the server pool</strong>, select this server, and then click <strong class=" ">Next</strong>.    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
Select <strong class=" ">Active Directory Domain Services</strong><i class=" ">.</i>    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
When prompted to add required features, click <strong class=" ">Add Features</strong>.<strong class=" "><br/></strong>    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
Proceed until the Confirmation page and click <strong class=" ">Install</strong>.    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
When the installation completes, click <strong class=" ">Close</strong>.    </span>
<strong class=" "><br/></strong></p>
</li></ol>    </div>
    <div class="section section-2" id="src-85924668_safe-id-aWQtLlBhcnQxOkFjdGl2ZURpcmVjdG9yeURvbWFpblNlcnZpY2VzdjcuNC4wLUNvbmZpZ3VyZUFjdGl2ZURpcmVjdG9yeURvbWFpblNlcnZpY2Vz">
        <h2 class="heading "><span>Configure Active Directory Domain Services</span></h2>
<p   
>    <span style="color: #000000;">
To configure Active Directory Domain Services:    </span>
</p>
<ol class=" "><li class=" "><p   
>    <span style="color: #000000;">
From Server Manager notifications a new task will be shown, click <strong class=" ">Promote this server to a domain controller</strong>.    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
Set the deployment operation to <strong class=" ">Add a new forest</strong>.    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
Enter the root domain name &lt;<strong class=" ">yourcompany.com&gt;</strong> and click <strong class=" ">Next</strong>.    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
Enter the Directory Services Restore Mode (DSRM) password <strong class=" ">&lt;PASSWORD&gt;</strong>, confirm the password, and then click <strong class=" ">Next</strong>.    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
When prompted the warning &quot;A delegation for this DNS server cannot be created&quot;, click <strong class=" ">Next</strong>.    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
Verify that the NetBIOS domain name is set to <strong class=" ">&lt;YOURCOMPANY&gt;</strong>, and then click <strong class=" ">Next</strong>.    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
When prompted the warning &quot;A delegation for this DNS server cannot be created&quot;, click <strong class=" ">Next</strong>.    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
Verify that the NetBIOS domain name is set to<strong class=" "> &lt;YOURCOMPANY&gt;</strong>, and then click <strong class=" ">Next</strong>.    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
Enter a location for the database, log files, and sysvol folders, and then click <strong class=" ">Next</strong>.    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
Review your selections and click <strong class=" ">Next</strong>.    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
Verify that all prerequisite checks passed successfully, then click <strong class=" ">Install</strong>.    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
When the installation completes, close the window and the server will be rebooted.<strong class=" "><br/></strong>    </span>
</p>
</li></ol>    </div>
    </div>
    <div class="section section-1" id="src-85924668_safe-id-aWQtLlBhcnQxOkFjdGl2ZURpcmVjdG9yeURvbWFpblNlcnZpY2VzdjcuNC4wLVN0ZXAyLUNyZWF0ZVNlcnZpY2VBY2NvdW50cw">
        <h1 class="heading "><span>Step 2 - Create Service Accounts</span></h1>
<p   
>    <span style="color: #000000;">
To create service accounts:    </span>
</p>
<ol class=" "><li class=" "><p   
>    <span style="color: #000000;">
Open the Server Manager and select <strong class=" ">Tools &gt; Activate Directory Users and Computers.</strong>    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
Navigate to &lt;<strong class=" ">yourcompany.com&gt;</strong> and select <strong class=" ">Users</strong>.<i class=" "></i>    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
Click <strong class=" ">Action</strong> &gt; <strong class=" ">New</strong> &gt; <strong class=" ">User</strong> and add the following service accounts:<br/>    </span>
</p>
<ol class=" "><li class=" "><p   
>    <span style="color: #000000;">
Add a service account with user login name (<strong class=" ">ces-service</strong>) and set the password to never expires. This account will be used for Certificate Enrollment Services.    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
Add a service account with user login name (<strong class=" ">servlet-service</strong>) and set the password to never expires. This account will be used for the Tomcat servlet.    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
Add a service account with user login name (<strong class=" ">autoenrollmentbind</strong>) and set the password to never expires. This account will be used for the Active Directory Bind account.    </span>
</p>
</li></ol></li><li class=" "><p   
>    <span style="color: #000000;">
Add the account (<strong class=" ">autoenrollmentbind</strong>) as a member of the <strong class=" ">Cert Publishers</strong> group.    </span>
<br/>    <span style="color: #000000;">
<img  class="emoticon emoticon-warning"  src="images/s/-98b7og/8401/7d0034e810b0e95b8c0694abfaf748cf5135c15a/_/images/icons/emoticons/warning.svg" alt="images/s/-98b7og/8401/7d0034e810b0e95b8c0694abfaf748cf5135c15a/_/images/icons/emoticons/warning.svg"   />
 For simplicity, a single service account can be used for all permissions to reduce complexity when working on active directory permissions. If using a single service account, add this single account to all areas outlined going forward.    </span>
</p>
</li></ol>    </div>
    <div class="section section-1" id="src-85924668_safe-id-aWQtLlBhcnQxOkFjdGl2ZURpcmVjdG9yeURvbWFpblNlcnZpY2VzdjcuNC4wLVN0ZXAzLUFkZEhvc3RzdG9ETlNTZXJ2aWNl">
        <h1 class="heading "><span>Step 3 - Add Hosts to DNS Service</span></h1>
<p   
>    <span style="color: #000000;">
To add hosts to the DNS service, perform the following steps:    </span>
</p>
<ol class=" "><li class=" "><p   
>    <span style="color: #000000;">
Open the Server Manager and select <strong class=" ">Tools </strong>&gt;<strong class=" ">DNS</strong>.    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
Expand your server name on the left-hand side, navigate to <strong class=" ">Forward Lookup Zone</strong> &gt; <strong class=" ">yourcompany.com</strong> and specify the following:    </span>
</p>
<ol class=" "><li class=" "><p   
>    <span style="color: #000000;">
Add a new host type (A) to EJBCA servers.    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
Add a new host type (A) to Tomcat servers.    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
Add a new host type (A) to CS servers.    </span>
</p>
</li></ol></li><li class=" "><p   
>    <span style="color: #000000;">
Increment the serial number of Start of Authority (SOA).    </span>
</p>
</li></ol>    </div>
        </div>

    </article>


            <nav id="ht-post-nav">
                <a href="Auto_Enrollment_Requirements.html" class="ht-post-nav-prev">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-prev" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Auto Enrollment Requirements</span>
        </a>
                <a href="Part_2__MS_Certification_Authority_and_Group_Policies.html" class="ht-post-nav-next">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-next" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Part 2: MS Certification Authority and Group Policies</span>
        </a>
    </nav>    
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>
</body>
</html>
