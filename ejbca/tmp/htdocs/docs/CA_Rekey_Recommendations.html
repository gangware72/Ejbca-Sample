<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>CA Rekey Recommendations - EJBCA - Documentation Space</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>


<script type="text/javascript" src="assets/js/scroll-tree.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script>
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="108530570">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">EJBCADS</span>
                    <img class="space-logo" src="EJBCADS.png" />
                </h1>
                <a href="EJBCA_7.4.3.2_Documentation.html" class="ht-space-link">
                    <h2>EJBCA - Documentation Space</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=93592601"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="EJBCA_7.4.3.2_Documentation.html">EJBCA - Documentation Space</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="EJBCA_Documentation.html">EJBCA Documentation</a></li>
                                                                                                         <li class="shortcut"><a href="EJBCA_Operations.html">EJBCA Operations</a></li>
                                                                                                         <li class="shortcut"><a href="EJBCA_Operations_Guide.html">EJBCA Operations Guide</a></li>
                                                                                                         <li class="shortcut"><a href="CA_Operations_Guide.html">CA Operations Guide</a></li>
                                                                                     <li><a href="Managing_CAs.html">Managing CAs</a></li>
                                                            </ul>
</div>            <h1 id="src-93592601"> <span>CA Rekey Recommendations</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">

<p   
>    <span style="color: #000000;">
The following describes PrimeKey's recommendations for CA Rekey in production environments.    </span>
</p>
<p   
></p>
<ul class="toc-indentation "><li class=" "><p   
><a   href="#src-93592601_id-.CARekeyRecommendationsv7.4.3-Introduction">Introduction</a></p>
</li><li class=" "><p   
><a   href="#src-93592601_id-.CARekeyRecommendationsv7.4.3-GeneralRecommendations">General Recommendations</a></p>
</li><li class=" "><p   
><a   href="#src-93592601_id-.CARekeyRecommendationsv7.4.3-MicrosoftApplicationPKIInteroperability">Microsoft Application PKI Interoperability</a></p>
<ul class="toc-indentation "><li class=" "><p   
><a   href="#src-93592601_id-.CARekeyRecommendationsv7.4.3-RenewaCAUsedbyMicrosoftApplications">Renew a CA Used by Microsoft Applications</a></p>
</li></ul></li><li class=" "><p   
><a   href="#src-93592601_id-.CARekeyRecommendationsv7.4.3-ICAOPKIInteroperability">ICAO PKI Interoperability</a></p>
</li></ul>    <div class="section section-1" id="src-93592601_id-.CARekeyRecommendationsv7.4.3-Introduction">
        <h1 class="heading "><span>Introduction</span></h1>
<p   
>    <span style="color: #000000;">
A Root CA functions as a trust anchor, in devices, operating systems, web browsers, etc. A Root CA issues itself a self-signed certificate that is provisioned into systems, typically in a trust store, keeping several Root CA certificates (for example the Mozilla web browser trust store). The self-signed certificate issued by a Root CA typically has long validity, commonly a minimum of 10 years, but ranging up to 40 years, or sometimes infinity for IoT initial device IDs. Shorter validity times also exist, for example, standardized by ICAO and EU for ePassports and eIDs.    </span>
</p>
<p   
>    <span style="color: #000000;">
The reason validity times are long for Root CAs is that the process of updating the trust store with a new Root CA certificate requires a separate process. Since the Root CA certificate is self-signed it can not be simply distributed as clients have no way of trusting the integrity of the new Root CA certificate and adding rogue Root CA certificates will compromise the security of the whole system. Processes to update Root CA certificates can be a software update, a specific trust store update (i.e. Mozilla, etc) or a specific protocol message. In some use cases, so-called link certificates are used to trust new Root CA certificates as they are distributed, by trusting the old Root CA certificate and chain for verifying the new Root CA certificate can be built. This is not supported in many use cases, however.    </span>
</p>
<p   
>    <span style="color: #000000;">
When a Root CA expires there are at least two different choices regarding the new Root CA:    </span>
</p>
<ul class=" "><li class=" "><p   
>    <span style="color: #000000;">
Keep the same Root CA Subject Distinguished Name (DN), only create a new CA key and CA certificate, i.e. the old Root CA with a new key.    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
Create a new Root CA Subject Distinguished Name (DN), create a new CA key and CA certificate, i.e. a fresh new Root CA.    </span>
</p>
</li></ul><p   
>    <span style="color: #000000;">
While the first approach may seem attractive it has a number of potential issues when considering a system with both old client (with only the old Root CA) and new client (with the old and the new Root CA):    </span>
</p>
<ul class=" "><li class=" "><p   
>    <span style="color: #000000;">
Complicating certificate path building with multiple CAs with the same DN, on both old and new client.    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
CRL issuance and verification of old and new clients.    </span>
</p>
</li></ul><p   
>    <span style="color: #000000;">
Although it may not sound too complicated, history is riddled with different client implementations making different decisions causing interoperability issues, and severe outages, over time. Keeping it simple can avoid some of these issues.    </span>
</p>
<p   
>    <span style="color: #000000;">
Due to this, the recommended approach when a Root CA expires is to start a new fresh Root CA, migrating client over to the new Root as they expire and are renewed. The old client can get the new Root CA certificate update in order to communicate with new clients, keeping certificate paths simple.    </span>
</p>
<p   
>    <span style="color: #000000;">
Having a process to completely replace an old CA with a new CA is always a good recommendation as having this process in place also makes your organization more agile when it comes to compromises, crypto vulnerabilities, and potential future topics such as post-quantum cryptography.    </span>
</p>
    </div>
    <div class="section section-1" id="src-93592601_id-.CARekeyRecommendationsv7.4.3-GeneralRecommendations">
        <h1 class="heading "><span>General Recommendations</span></h1>
<p   
>    <span style="color: #000000;">
Our general recommendation, which is more detailed in the section below are to always create a new CA subject DN when renewing Root CAs.    </span>
</p>
<ul class=" "><li class=" "><p   
>    <span style="color: #000000;">
Create a new Unique CA DN, e.g.; CN=Corporate Issuing CA G1 or CN=Corporate Issuing CA G2, etc.    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
Perform the process in good time before the old CA expires and transition clients in a controlled way.    </span>
</p>
</li></ul><p   
>    <span style="color: #000000;">
Unless you really know what you are doing, in which case EJBCA has easy to use functions for renewal keeping the same CA subject DN.    </span>
</p>
    </div>
    <div class="section section-1" id="src-93592601_id-.CARekeyRecommendationsv7.4.3-MicrosoftApplicationPKIInteroperability">
        <h1 class="heading "><span>Microsoft Application PKI Interoperability</span></h1>
<p   
>    <span style="color: #000000;">
Microsoft applications do not support link certificates for the Root CA, and also requires the CA key that signed the issued certificate to sign the corresponding CRL. EJBCA signs the CRL with the latest CA key, which is normally not a problem when the old CA certificate expires and a new is created as CRLs entries are removed upon expiration. A key update in EJBCA before CA certificate expiration would break Microsoft applications from being able to validate certificates issued by the previous CA key. The diagram below illustrates EJBCA and Microsoft CA signing.    </span>
</p>
<p   
><img  class="drawio-diagram-image"  src="images/inline/db80a020cce0fdaab64a5018c12f97bd1ef3345e.png" alt="images/inline/db80a020cce0fdaab64a5018c12f97bd1ef3345e.png" width="400"  />
    </p>
    <div class="section section-2" id="src-93592601_id-.CARekeyRecommendationsv7.4.3-RenewaCAUsedbyMicrosoftApplications">
        <h2 class="heading "><span>Renew a CA Used by Microsoft Applications</span></h2>
<p   
>PrimeKey recommends creating a new CA DN for CA key updates when using EJBCA in environments that support Microsoft applications. This is a model that Web PKI / WebTrust PKIs use and it provides a number of advantages for the PKI that include:</p>
<ul class=" "><li class=" "><p   
>Unique CA DN, e.g.; CN=Corporate Issuing CA G1 or CN=Corporate Issuing CA G2</p>
</li><li class=" "><p   
>Users and PKI administrators can easily distinguish which CA chain is which</p>
</li><li class=" "><p   
>Maximum interoperability with all applications</p>
</li></ul><p   
>The Web PKI model is illustrated in the following diagram.</p>
<p   
><img  class="drawio-diagram-image"  src="images/inline/d618b5d2d0862cb150ec9f1058553296dac8f96d.png" alt="images/inline/d618b5d2d0862cb150ec9f1058553296dac8f96d.png" width="400"  />
    </p>
<p   
>    <span style="color: #000000;">
The example shown in this illustration consists of a Root CA with a 25 year lifetime and Subordinate CA with a 5 year lifetime. The G1 Subordinate CA issues certificates for 3 years, and at the third year issuance transitions to the Subordinate CA G2. Subordinate CA G1 is only online to sign CRL's and OCSP signer certificates until it expires. All new certificate issuance is off of Subordinate CA G2. Once the 3rd year of issuance from Subordinate CA G2 approaches Subordinate CA G3 is deployed. This process repeats until the Root CA is near expiry. When the Root CA nears expiry a new Root CA and Subordinate CA are deployed.    </span>
</p>
    </div>
    </div>
    <div class="section section-1" id="src-93592601_id-.CARekeyRecommendationsv7.4.3-ICAOPKIInteroperability">
        <h1 class="heading "><span>ICAO PKI Interoperability</span></h1>
<p   
>    <span style="color: #000000;">
In the ICAO PKI (ePassports), link certificates are used to build trust between old and new Root CA certificates (called a Country Signing CA in ICAO PKI). ICAO PKI has a special (non RFC5280 compliant) way of dealing with CRLs, where a country only has one CRL even f there are multiple (generations) of CAs, i.e. all CRL records from old CAs are moved over to the new CRL even if the issued DN is different. To handle this, among other things, ICAO has defined a specific Name Change Extension, used to signal that the new Root CA has a new subject DN.    </span>
</p>
<p   
>    <span style="color: #000000;">
The recommendations for when updating a Country Signing CA is the same as for the Microsoft case:    </span>
</p>
<ul class=" "><li class=" "><p   
>    <span style="color: #000000;">
Create a new Unique CA DN, e.g.; CN=Country Signing CA G1 or CN=Country Signing CA G2, or use another DN component, i.e. CN=CSCA, SerialNumber=100 or CN=CSCA, SerialNumber=101, etc    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
Use the ICAO NameChange certificate extension    </span>
</p>
</li><li class=" "><p   
>    <span style="color: #000000;">
Create a link certificate when generating the new CSCA    </span>
</p>
</li></ul><p   
>    <span style="color: #000000;">
For more information, see    </span>
 <a   href="ePassport_PKI.html">ePassport PKI</a>.</p>
    </div>
        </div>

    </article>


            <nav id="ht-post-nav">
                <a href="Signing_an_External_CA.html" class="ht-post-nav-prev">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-prev" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Signing an External CA</span>
        </a>
                <a href="Managing_Certificate_Profiles.html" class="ht-post-nav-next">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-next" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Managing Certificate Profiles</span>
        </a>
    </nav>    
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>
</body>
</html>
