<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Migrating from other CAs to EJBCA - EJBCA - Documentation Space</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>


<script type="text/javascript" src="assets/js/scroll-tree.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script>
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="108530570">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">EJBCADS</span>
                    <img class="space-logo" src="EJBCADS.png" />
                </h1>
                <a href="EJBCA_7.4.3.2_Documentation.html" class="ht-space-link">
                    <h2>EJBCA - Documentation Space</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=85922384"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="EJBCA_7.4.3.2_Documentation.html">EJBCA - Documentation Space</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="EJBCA_Documentation.html">EJBCA Documentation</a></li>
                                                                                     <li><a href="Tutorials_and_Guides.html">Tutorials and Guides</a></li>
                                                            </ul>
</div>            <h1 id="src-85922384"> <span>Migrating from other CAs to EJBCA</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">

<p   
>This section includes information on CA migration and outlines a general migration procedure as well as case-specific information on migrating from different CAs to EJBCA.</p>
<p   
><ul class="toc-indentation "><li class=" "><p   
><a   href="#src-85922384_id-.MigratingfromotherCAstoEJBCAv7.4.0-CASpecificMigrationProcedures">CA Specific Migration Procedures</a></p>
</li><li class=" "><p   
><a   href="#src-85922384_id-.MigratingfromotherCAstoEJBCAv7.4.0-GenericMigrationProcedure">Generic Migration Procedure</a></p>
</li></ul></p>
    <h3 id="src-85922384_id-.MigratingfromotherCAstoEJBCAv7.4.0-CASpecificMigrationProcedures" class="heading "><span>CA Specific Migration Procedures</span></h3>
<p   
>The following describe case-specific information on how to migrate from other CAs to EJBCA:<ul class=" "><li class=" "><p   
><a   href="Migrating_RSA_Keon_CA_with_nCipher.html">Migrating RSA Keon CA with nCipher</a>: Describes how to migrate an RSA Keon CA using nCipher HSM to EJBCA and covers migrating the CA signing keys, importing the CAs to EJBCA and importing issued certificates to EJBCA. The result is a setup in EJBCA that can continue operation transparently.</p>
</li><li class=" "><p   
><a   href="Migrating_Microsoft_CA_to_EJBCA.html">Migrating Microsoft CA to EJBCA</a></p>
</li><li class=" "><p   
><a   href="Migrating_an_OpenSSL_CA_to_EJBCA.html">Migrating OpenSSL CA to EJBCA</a></p>
</li></ul></p>
    <h3 id="src-85922384_id-.MigratingfromotherCAstoEJBCAv7.4.0-GenericMigrationProcedure" class="heading "><span>Generic Migration Procedure</span></h3>
<p   
>The following outlines a generic process when migrating a CA to EJBCA. The actual migration may hit roadblocks such as non-supported certificate contents. Such issues are often found during a test migration, performed in order to solve similar issues prior to a final migration in production.</p>
    <h4 id="src-85922384_id-.MigratingfromotherCAstoEJBCAv7.4.0-MigrationPlan" class="heading "><span>Migration Plan</span></h4>
<p  class="western" 
>This generic migration plan can be used as a base for migrating any CA to EJBCA.</p>
<p  class="western" 
>Transferring data from another CA involves four different types of data:<ul class=" "><li class=" "><p  class="western" 
>HSM key material</p>
</li><li class=" "><p  class="western" 
>CA certificates</p>
</li><li class=" "><p  class="western" 
>End entity certificates</p>
</li><li class=" "><p  class="western" 
>Revocation information</p>
</li></ul></p>
<p   
></p>
    <h4 id="src-85922384_id-.MigratingfromotherCAstoEJBCAv7.4.0-MigrationSteps" class="heading "><span>Migration Steps</span></h4>
<p   
>A complete migration involves a number of steps. The following displays an overview of the steps involved, followed by more detailed information.</p>
    <h5 id="src-85922384_id-.MigratingfromotherCAstoEJBCAv7.4.0-ConfigureProfiles" class="heading "><span>Configure Profiles</span></h5>
<p  class="western" 
>Before the certificates are imported, all the End Entity Profiles and Certificate Profiles used by the imported CAs and End Entities should be configured.</p>
<p   
>    <h5 id="src-85922384_id-.MigratingfromotherCAstoEJBCAv7.4.0-CAandCertificateImport" class="heading "><span>CA and Certificate Import</span></h5>
<ul class=" "><li class="western "><p   
>Once the key material is on the HSM and ready to be used, the CAs can be imported. Thus importing CA certificates and creating the CA objects in EJBCA, including Crypto Tokens. The import of CAs is performed using command line scripts, requiring information of the HSM slot, the HSM key labels, and the CA certificate.</p>
</li><li class="western "><p   
>When the CAs are created, the End Entity certificates and CRL can be imported. The import of End Entity certificates is performed using command line scripts, requiring information of the certificate, the issuing CA, and the 'username' to be used in EJBCA.</p>
</li></ul></p>
    <h6 id="src-85922384_id-.MigratingfromotherCAstoEJBCAv7.4.0-ImportProcess" class="heading "><span>Import Process</span></h6>
<p  class="western" 
>Once everything is tested, the import process involves the following steps:<ol class=" "><li class="western "><p   
>Get production data</p>
</li><li class=" "><p  class="western" 
>Validate production data</p>
</li><li class=" "><p  class="western" 
>Import</p>
</li></ol></p>
    <h6 id="src-85922384_id-.MigratingfromotherCAstoEJBCAv7.4.0-ConfigurationAfterTransfer" class="heading "><span>Configuration After Transfer</span></h6>
<p  class="western" 
>Validate the configuration of the following CA Configuration, Certificate Profiles, and End Entity Profiles fields after the transfer:<ul class=" "><li class=" "><p  class="western" 
>Set up CDP and AIA in Profiles.</p>
</li><li class=" "><p  class="western" 
>Set CRL validity.</p>
</li><li class=" "><p  class="western" 
>Set CA Certificate Profiles and configure CA settings.</p>
</li><li class=" "><p  class="western" 
>Issue OCSP certificates.</p>
</li><li class=" "><p  class="western" 
>Revoke old OCSP certificates.</p>
</li><li class=" "><p  class="western" 
>Publish to OCSP.</p>
</li><li class=" "><p  class="western" 
>Issue CRL.</p>
</li></ul></p>
<p  class="western" 
>Once the configuration has been verified, the EJBCA system can be run in production.</p>
    <h4 id="src-85922384_id-.MigratingfromotherCAstoEJBCAv7.4.0-MigrationPrerequisites" class="heading "><span>Migration Prerequisites </span></h4>
<p   
>The following requirements should be checked in order to migrate successfully.</p>
    <h5 id="src-85922384_id-.MigratingfromotherCAstoEJBCAv7.4.0-HSMRequirements" class="heading "><span>HSM Requirements</span></h5>
<p  class="western" 
>Labels on the private keys in the HSM must be used and should have a sane value. The following pattern format is recommended:</p>
<p  class="western" style="text-align:left;"
><tt class=" ">&lt;caname&gt;SignKey&lt;date&gt;</tt> for example, <strong class=" ">rootCAG3SignKey20160226</strong> or <strong class=" ">highAssuranceCASignKey20160226</strong></p>
<p  class="western" 
>Do not use special or internalized characters in the labels.</p>
    <h5 id="src-85922384_id-.MigratingfromotherCAstoEJBCAv7.4.0-CertificateRequirements" class="heading "><span>Certificate Requirements</span></h5>
    <h6 id="src-85922384_id-.MigratingfromotherCAstoEJBCAv7.4.0-CertificatesandCRLsDelivered" class="heading "><span>Certificates and CRLs Delivered</span></h6>
<p   
>The following must be downloaded and made available:<ul class=" "><li class="western "><p   
>All certificates in the whole CA chain (in PEM or DER format), including external CA certificates, i.e. CA certificates of the previous solution.</p>
</li><li class="western "><p   
>All issued certificates (in PEM or DER format).</p>
</li><li class="western "><p   
>CRLs, per CA. Only the latest CRL is required unless the revocation history of expired certificates are also needed.</p>
</li></ul></p>
    <h6 id="src-85922384_id-.MigratingfromotherCAstoEJBCAv7.4.0-CertificateTechnicalRequirements" class="heading "><span>Certificate Technical Requirements</span></h6>
<p  class="western" 
>The following are requirements on the certificate content:<ul class=" "><li class=" "><p  class="western" 
>Only standard subject DN attributes. RFC5280 and CABForum.</p>
</li><li class=" "><p  class="western" 
>Only standard subject altNames. RFC5280 with the additional restrictions.</p>
<ul class=" "><li class=" "><p  class="western" 
>No OtherName, except MS UPN, as these are usually custom</p>
</li><li class=" "><p  class="western" 
>No x400Address</p>
</li><li class=" "><p  class="western" 
>No ediPartyName</p>
</li><li class=" "><p  class="western" 
>No registeredID</p>
</li></ul></li><li class=" "><p  class="western" 
>Only standard certificate extensions. RFC5280.</p>
</li><li class=" "><p  class="western" 
>The following special characters are not allowed to be used in the subject or issuer DN.</p>
<ul class=" "><li class=" "><p  class="western" 
>\n (newline)</p>
</li><li class=" "><p  class="western" 
>\r (carriage return)</p>
</li><li class=" "><p  class="western" 
>\0 (null)</p>
</li><li class=" "><p  class="western" 
>;</p>
</li><li class=" "><p  class="western" 
>!</p>
</li><li class=" "><p  class="western" 
>%</p>
</li><li class=" "><p  class="western" 
>` (backtick)</p>
</li><li class=" "><p  class="western" 
>?</p>
</li><li class=" "><p  class="western" 
>$</p>
</li><li class=" "><p  class="western" 
>~</p>
</li></ul></li></ul></p>
    <h6 id="src-85922384_id-.MigratingfromotherCAstoEJBCAv7.4.0-CRLsandRevocationInformation" class="heading "><span>CRLs and Revocation Information</span></h6>
<p  class="western" 
>CRLs are used to transfer the revocation information.</p>
    <h6 id="src-85922384_id-.MigratingfromotherCAstoEJBCAv7.4.0-ExpiredCertificates" class="heading "><span>Expired Certificates</span></h6>
<p  class="western" 
>Expired certificates can be imported and CRLs are used for revocation information. If only the latest CRL is downloaded, expired certificates may not be marked as revoked, even if they were., since expired certificates are not included in CRLs (following RFC5280).</p>
    <h6 id="src-85922384_id-.MigratingfromotherCAstoEJBCAv7.4.0-CertificateDeliveryFormat" class="heading "><span>Certificate Delivery Format</span></h6>
<p  class="western" 
>Certificates should be downloaded and made available in a directory layout, per CA, per certificate profile.</p>
<p  class="western" 
><i class=" ">CAName/CertificateProfileName/uid.pem (&hellip;)</i></p>
<p  class="western" 
>The uid can be any identifier used as 'username' in EJBCA if such information exists.</p>
    <h5 id="src-85922384_id-.MigratingfromotherCAstoEJBCAv7.4.0-AuditLogs" class="heading "><span>Audit Logs</span></h5>
<p  class="western" 
>Audit logs should be exported securely and stored off-line to be available in an audit.</p>
    <h4 id="src-85922384_id-.MigratingfromotherCAstoEJBCAv7.4.0-QuestionsandNotes" class="heading "><span>Questions and Notes</span></h4>
<p   
>Questions to consider prior to a migration:<ul class=" "><li class=" "><p  class="western" 
>Expected certificate volumes?</p>
</li><li class=" "><p  class="western" 
>Consider exporting data from the old CA in order to test validity.</p>
</li><li class=" "><p  class="western" 
>Will the migration be the first CAs created (except for the Management CA)? i.e. the CA import will be the &ldquo;key ceremony&rdquo;.</p>
</li><li class=" "><p  class="western" 
>Will the systems be running in parallel? If so, it is necessary to do a kind of &ldquo;delta migration&rdquo;.</p>
</li><li class=" "><p  class="western" 
>What will be used as 'username' in EJBCA?</p>
</li></ul></p>
<p  class="western" 
>A rather extensive testing of import can be performed without private keys (provided we have all the certs/CRLs). The CAs will all get imported as externals and the profile conformance of provided data can be validated.</p>
    <h4 id="src-85922384_id-.MigratingfromotherCAstoEJBCAv7.4.0-TestMigrationProcess" class="heading "><span>Test Migration Process</span></h4>
<p  class="western" 
>The process should be tested thoroughly before migration.<ul class=" "><li class=" "><p  class="western" 
>Get test data.</p>
</li><li class=" "><p  class="western" 
>Validate test data.</p>
</li><li class=" "><p  class="western" 
>If using an HSM, make an HSM slot plan, which slot is used for which CA.</p>
</li><li class=" "><p  class="western" 
>Import HSM slots according to the slot plan.</p>
</li><li class=" "><p  class="western" 
>Generate new keys for a Management CA and install EJBCA. Now a Management CA is created.</p>
</li><li class=" "><p   
>Import CAs.</p>
</li><li class=" "><p  class="western" 
>Import end entity certificates.</p>
</li><li class=" "><p  class="western" 
>Import CRLs.</p>
</li></ul></p>
<p  class="western" 
>After testing, the system should be validated and test certificates issued.</p>
<p   
></p>
        </div>

    </article>


            <nav id="ht-post-nav">
                <a href="Enabling_Debug_Logging.html" class="ht-post-nav-prev">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-prev" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Enabling Debug Logging</span>
        </a>
                <a href="Migrating_RSA_Keon_CA_with_nCipher.html" class="ht-post-nav-next">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-next" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Migrating RSA Keon CA with nCipher</span>
        </a>
    </nav>    
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>
</body>
</html>
