<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Certificate Field Validators - EJBCA - Documentation Space</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>


<script type="text/javascript" src="assets/js/scroll-tree.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script>
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="108530570">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">EJBCADS</span>
                    <img class="space-logo" src="EJBCADS.png" />
                </h1>
                <a href="EJBCA_7.4.3.2_Documentation.html" class="ht-space-link">
                    <h2>EJBCA - Documentation Space</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=85926043"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="EJBCA_7.4.3.2_Documentation.html">EJBCA - Documentation Space</a></li>
                                                                                                             <li><a href="" onclick="$('.shortcut').each(function(){$(this).removeClass('shortcut')}); $(this).parent().addClass('shortcut'); return false;">...</a> </li>
                                        <li class="shortcut"><a href="EJBCA_Documentation.html">EJBCA Documentation</a></li>
                                                                                                         <li class="shortcut"><a href="EJBCA_Operations.html">EJBCA Operations</a></li>
                                                                                                         <li class="shortcut"><a href="EJBCA_CA_Concept_Guide.html">EJBCA CA Concept Guide</a></li>
                                                                                     <li><a href="Validators_Overview.html">Validators Overview</a></li>
                                                            </ul>
</div>            <h1 id="src-85926043"> <span>Certificate Field Validators</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">

<p   
>Certificate field validators are run on specific fields on the CSR, such as the dnsName SAN field.</p>
<p   
></p>
<ul class="toc-indentation "><li class=" "><p   
><a   href="#src-85926043_id-.CertificateFieldValidatorsv7.4.0-GoogleSafeBrowsingValidator">Google Safe Browsing Validator</a></p>
</li><li class=" "><p   
><a   href="#src-85926043_id-.CertificateFieldValidatorsv7.4.0-CAAValidator">CAA Validator</a></p>
</li><li class=" "><p   
><a   href="#src-85926043_id-.CertificateFieldValidatorsv7.4.0-DomainBlacklistValidator">Domain Blacklist Validator</a></p>
</li></ul>    <div class="section section-1" id="src-85926043_id-.CertificateFieldValidatorsv7.4.0-GoogleSafeBrowsingValidator">
        <h1 class="heading "><span>Google Safe Browsing Validator</span></h1>
<p   
>The Google Safe Browsing Validator performs a lookup of the domains in the certificate against the <a  class="external-link" href="https://developers.google.com/safe-browsing/v4">Google Safe Browsing Lookup API v4</a>. The Google Safe Browsing API is listing websites used for distribution of malware and phishing.</p>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>The Google Safe Browsing API should only be used for non-commerical purposes.</p>
        </div>
    </div>
<p   
>Before the validator can perform lookups against the API, you need to create an API key using the Google Developer Console, see <a  class="external-link" href="https://console.developers.google.com/">https://console.developers.google.com/</a>.</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/85926043/Google_Safe_Browsing_Validator.png" alt="images/download/attachments/85926043/Google_Safe_Browsing_Validator.png"  height="400" />
    </p>
    </div>
    <div class="section section-1" id="src-85926043_id-.CertificateFieldValidatorsv7.4.0-CAAValidator">
        <h1 class="heading "><span>CAA Validator</span></h1>
<p   
></p>
<p   
><span class="status blue " >ENTERPRISE</span>
 This is an EJBCA Enterprise feature.</p>
<p   
>The Certificate Authority Authorization (CAA) validator is based on <a  class="external-link" href="https://tools.ietf.org/html/rfc6844">RFC 6844</a>, <a  class="external-link" href="http://www.rfc-editor.org/errata/eid5065">erratum 5065</a> and the CA/Browser Forum <a  class="external-link" href="https://cabforum.org/wp-content/uploads/CA-Browser-Forum-BR-1.4.5.pdf">Baseline Requirements Certificate Policy for the Issuance and Management of Publicly-Trusted Certificates</a>. These specify that for complying CAs issuing certificates containing DNSName values in the subjectAltName extension, the CA must perform a lookup check to the DNS(s) of all specified names and check that the CAA records allow issuance for the given issuer.</p>
    <div  class="confbox admonition admonition-info">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>The result of all CAA lookups is written to the server logs on INFO level.</p>
        </div>
    </div>
<p   
>A typical CAA record has the following format:</p>
    <div  class="confbox programlisting">
                <div class="content">
        <pre><code>example.com. 243	IN	CAA	0 issue &quot;ca.org&quot;</code></pre>
        </div>
    </div>
<p   
>This record says that the issuer known as &quot;ca.org&quot; is permitted to issue certificates (including wildcards) for all domains and subdomains to the domain &quot;example.com&quot;. In the EJBCA case, this means that according to CAA, an end entity that includes the field <strong class=" ">DNSNAME=example.com</strong> in the subjectAltName (SAN) extension must pass a CAA Validator check before having a certificate issued to it.</p>
    <div class="section section-2" id="src-85926043_id-.CertificateFieldValidatorsv7.4.0-IssuancePhase">
        <h2 class="heading "><span>Issuance Phase</span></h2>
<p   
>The CAA Validator can be run during the data phase only.</p>
    </div>
    <div class="section section-2" id="src-85926043_id-.CertificateFieldValidatorsv7.4.0-Fields">
        <h2 class="heading "><span>Fields</span></h2>
<p   
>EJBCA allows the administrator to configure the following when setting up a CAA Validator:</p>
    <div  class="tablewrap">
        <table class="wrapped relative-table confluenceTable">
                    <colgroup>
                                    <col  width="13%"/>
                                    <col  width="86%"/>
                            </colgroup>
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>Field Name</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>Description</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Issuers</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>This value should match the value field in the CAA record of the DNS, thus &quot;ca.org&quot; in the above example. If required, you can specify multiple issuers by separating them with a semicolon. For example, specifying &quot;ca1.org;ca2.org;ca3.org&quot; will match a CAA record with either ca1.org, ca2.org or ca3.org.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>DNS Resolver</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Optional field for specifying an IP address as DNS Resolver (such as 8.8.8.8 or 8.8.4.4). If left blank, Google's Public DNS will be used.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Lookup DNAMEs</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Select to look up and follow any DNAME records found during CAA processing. To comply with RFC 6844, it is recommended to keep this option enabled.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Validate DNSSEC</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Select to validate DNSSEC to be validated. If enabled and your DNS is signed with DNSSEC and your DNS presents a faulty set of records (suggesting a possible MitM attack), CAA validation will fail. It is strongly recommended to enable DNSSEC checks to ensure the authenticity of DNS responses.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Trust Anchor</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Trust anchors are configured to allow obtaining secure answers from the root zone of the DNS using DNSSEC. By default, IANA root anchor is used. This value may be modified but should remain unchanged unless the record is signed by another trust anchor.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Fail on lookup error</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>The default behavior is to permit issuance if a lookup error is encountered more than once and EJBCA can establish that the domain is not signed with DNSSEC. To always prohibit issuance when a lookup error is encountered, enable this option. To have this option enabled may be a compliance requirement if you are contacting your own DNS resolver for CAA lookups.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Use IODEF E-mail</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Select to enable sending e-mails to any mailto-links registered on the DNS as CAA IODEF records. Doing so enables the following additional settings:</p>
    <div  class="tablewrap">
        <table class="wrapped confluenceTable">
        <thead class=" "></thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>From</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>The <strong class=" ">From</strong> field in the resulting e-mail.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Subject</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>The <strong class=" ">Subject</strong> line in the resulting e-mail.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Additional Information:</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Any additional information required, in addition to the following default message which will be appended at the end:</p>
<p   
><i class=" ">A faulty Certificate Request was made for the domain 'example.com' for the issuer ca.com which was rejected by the CA due to the issuer not having a CAA record on the domain's DNS.</i></p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Use IODEF WEB</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Enables sending IODEF incident reports to any http/s-links registered on the DNS as CAA IODEF records.</p>
            </td>
        </tr>
</tbody>        </table>
            </div>
<p   
></p>
            </td>
        </tr>
</tbody>        </table>
            </div>
<p   
></p>
    <div  class="confbox admonition admonition-note">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>Note the following regarding CAA validation:</p>
<ul class=" "><li class=" "><p   
>CAA validation will pass if the DNS lacks CAA records entirely.</p>
</li><li class=" "><p   
>EJBCA uses IPv4 to perform lookups of CAA records.</p>
</li><li class=" "><p   
>EJBCA currently does not validate parameters in CAA records, but such records will still be evaluated correctly. Parameter handling is planned in future versions.</p>
</li><li class=" "><p   
>The CAA Validator requires TCP and UDP port 53 to be open in the firewall.</p>
</li><li class=" "><p   
>Current iodef implementation does not support TLS protocol to send iodef reports over a secure connection. This will be added per request by customers or in future releases.</p>
</li><li class=" "><p   
>Another limitation is that the implementation does not support callback, only immediate responses with code 200 OK are supported. For more information, refer to <a  class="external-link" href="https://tools.ietf.org/html/rfc6546">RFC-6546</a>.</p>
</li><li class=" "><p   
>The attributes in the produced incident report are the minimum required ones. Optionals are ignored for now but could be added if requested.</p>
</li><li class=" "><p   
>EJBCA currently does not support the CAA Contact property as defined in section 1.6.1 of the Baseline Requirements.</p>
</li></ul>        </div>
    </div>
    </div>
    <div class="section section-2" id="src-85926043_id-.CertificateFieldValidatorsv7.4.0-CAAValidatorLogging">
        <h2 class="heading "><span>CAA Validator Logging</span></h2>
<p   style="text-align:left;"
>The CAA validator logs both success and failure. Since success can be considered a security event, to be shown as evidence, this is logged in the security audit log. Failures are not security events per se and logged to the standard server log at info level.</p>
<p   
>Example failure:</p>
    <div  class="confbox programlisting">
                <div class="content">
        <pre><code>15:49:07,017 INFO  [org.cesecore.keys.validation.KeyValidatorSessionBean] (default task-24) VALIDATOR_VALIDATION_FAILED;FAILURE;VALIDATOR;CORE;msg=CAA Validator 'CAA Validator' failed issuance of certificates 
to issuer primekey.com, with messages: 
[Not allowed to issue certificate for dnsName *.allow.klaan.nu. Result type was: Issuance of wildcard certificates for this domain is prohibited. Parameters: {} Message: 
, Allowed to issue certificate for dnsName *.klaan.nu. Result type was: May issue, no CAA results for domain. Parameters: {} Message: 
, Not allowed to issue certificate for dnsName allow.klaan.nu. Result type was: Rejected due to issuer not having a CAA record at domain's DNS, or issuance being prohibited. Parameters: {} Message: ].			</code></pre>
        </div>
    </div>
<p   
>Example success:</p>
    <div  class="confbox programlisting">
                <div class="content">
        <pre><code>15:50:58,930 INFO  [org.cesecore.audit.impl.log4j.Log4jDevice] (default task-8) 2017-09-20 15:50:58+02:00;VALIDATOR_VALIDATION_SUCCESS;SUCCESS;VALIDATOR;CORE;ejbca;1865017768;;caaklaan1;msg=CAA Validator 'CAA Validator' 
has permitted issuance of certificates to issuer primekey.com, with messages: 
[Allowed to issue certificate for dnsName *.klaan.nu. Result type was: May issue, no CAA results for domain. Parameters: {} Message: 
, Allowed to issue certificate for dnsName a.allow.klaan.nu. Result type was: May issue. Parameters: {} Message: primekey.com
, Allowed to issue certificate for dnsName b.allow.klaan.nu. Result type was: May issue. Parameters: {} Message: primekey.com].		</code></pre>
        </div>
    </div>
<p   style="text-align:left;"
>The debug logging DNS lookup result available can amount to large volumes and is therefore set at a debug level disabled by default. To enable a separate DNS lookup log, you can send the DEBUG log for the class CaaDnsLookup to a separate log, similar to the OCSP Transaction and Audit logging. For more information, see <a   href="Logging.html">Logging</a>.</p>
    </div>
    </div>
    <div class="section section-1" id="src-85926043_id-.CertificateFieldValidatorsv7.4.0-DomainBlacklistValidator">
        <h1 class="heading "><span>Domain Blacklist Validator</span></h1>
<p   
>Domain Blacklist Validators allows DNSNAME attributes in Subject Alternative Name to be checked before issuance.</p>
<p   
>The intended use case is to require confirmation during the approval process for certain high-value domains (provided that approvals are enabled), but Domain Blacklist Validators can also be used for blocking known fraud sites, for example.</p>
<p   
>You can configure multiple validators with different settings. The following example shows a validator configured to allow validation while warning the administrator during the approval process.</p>
<p   
><img  class="confluence-embedded-image"  src="images/download/attachments/85926043/domain_blacklist_validator.png" alt="images/download/attachments/85926043/domain_blacklist_validator.png" width="600"  />
    </p>
    <div class="section section-2" id="src-85926043_id-.CertificateFieldValidatorsv7.4.0-IssuancePhase.1">
        <h2 class="heading "><span>Issuance Phase</span></h2>
<p   
>The Domain Blacklist Validator can be run during the data or approval phase. If configured to run during the approval phase, and validation fails, a confirmation message will be shown in the RA Web for the approving administrators.</p>
    <div  class="confbox admonition admonition-warning">
                            <span class="admonition-icon confluence-information-macro-icon"></span>
                <div class="admonition-body">
<p   
>If the validator has been set to run during the approval phase and no approval requirements exist for the CA or Certificate Profile, then it will have no effect.</p>
        </div>
    </div>
    </div>
    <div class="section section-2" id="src-85926043_id-.CertificateFieldValidatorsv7.4.0-Fields.1">
        <h2 class="heading "><span>Fields</span></h2>
<p   
>The following lists available Domain Blacklist Validator fields:</p>
    <div  class="tablewrap">
        <table class="relative-table wrapped confluenceTable">
                    <colgroup>
                                    <col  width="13%"/>
                                    <col  width="86%"/>
                            </colgroup>
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>Field Name</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>Description</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Normalizations to apply</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>The normalization to be performed against the domains before comparing against the blacklist. Only one normalization is currently available:</p>
<p   
><strong class=" ">ASCII Lookalikes:</strong> This normalizes character or character sequences that look similar. IDN/Punicode characters of domains are not changed. The following characters and character sequences are normalized:</p>
    <div  class="tablewrap">
        <table class="wrapped confluenceTable">
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>From</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>To</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>From</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>To</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>From</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>To</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>From</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>To</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>From</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>To</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>From</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>To</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>From</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>To</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="highlight-grey confluenceTd" rowspan="1" colspan="1">
    <p   
>ci</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>a</p>
            </td>
                <td  class="highlight-grey confluenceTd" rowspan="1" colspan="1">
    <p   
>cl</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>d</p>
            </td>
                <td  class="highlight-grey confluenceTd" rowspan="1" colspan="1">
    <p   
>vv</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>w</p>
            </td>
                <td  class="highlight-grey confluenceTd" rowspan="1" colspan="1">
    <p   
>6</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>b</p>
            </td>
                <td  class="highlight-grey confluenceTd" rowspan="1" colspan="1">
    <p   
>9</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>g</p>
            </td>
                <td  class="highlight-grey confluenceTd" rowspan="1" colspan="1">
    <p   
>I (i)</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>l (L)</p>
            </td>
                <td  class="highlight-grey confluenceTd" rowspan="1" colspan="1">
    <p   
>2</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>z</p>
            </td>
        </tr>
    <tr>
            <td  class="highlight-grey confluenceTd" rowspan="1" colspan="1">
    <p   
>fi</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>a</p>
            </td>
                <td  class="highlight-grey confluenceTd" rowspan="1" colspan="1">
    <p   
>rn</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>m</p>
            </td>
                <td  class="highlight-grey confluenceTd" rowspan="1" colspan="1">
    <p   
>0 (zero)</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>o</p>
            </td>
                <td  class="highlight-grey confluenceTd" rowspan="1" colspan="1">
    <p   
>q</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>g</p>
            </td>
                <td  class="highlight-grey confluenceTd" rowspan="1" colspan="1">
    <p   
>1 (one)</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>l (L)</p>
            </td>
                <td  class="highlight-grey confluenceTd" rowspan="1" colspan="1">
    <p   
>5</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>s</p>
            </td>
                <td  class="highlight-grey confluenceTd" rowspan="1" colspan="1">
    <p   
>u</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>v</p>
            </td>
        </tr>
</tbody>        </table>
            </div>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Checks to perform</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>The checks control how domains are compared against the entries in the blacklist. At least one must be selected.</p>
<p   
><strong class=" ">Base domain:</strong> All base domains will be compared against the blacklist. If issuing a certificate for &quot;a.b.example.com&quot;, then &quot;a.b.example.com&quot;, &quot;b.example.com&quot;, &quot;example.com&quot;, and &quot;com&quot; will be checked against the blacklist.</p>
<p   
><strong class=" ">Domain component:</strong> All domain components will be checked, individually. So for &quot;a.b.example.com&quot;, the blacklist will be searched for &quot;a&quot;, &quot;b&quot;, &quot;example&quot;, and &quot;com&quot;.</p>
<p   
><strong class=" ">Exact match:</strong> Domains that match exactly will be matched. Note that this check is included with &quot;Base domain&quot;. For &quot;a.b.example.com&quot;, it will only search the blacklist for &quot;a.b.example.com&quot;.</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Existing blacklist</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Shows information about the currently active blacklist and only displays once a blacklist has been uploaded.</p>
<p   
><strong class=" ">Number of entries:</strong> Number of blacklisted domains. The effective number of blacklisted domains may be greater due to normalization and the checks performed.</p>
<p   
><strong class=" ">Upload date:</strong> Time when the blacklist was uploaded. Shown in UTC timezone.</p>
<p   
><strong class=" ">SHA-256:</strong> Hash of the entire file, as uploaded (i.e. including comments and whitespace).</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Upload new blacklist</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Click <strong class=" ">Browse</strong> to upload a blacklist. Any existing blacklist will be replaced when a new one is uploaded.</p>
<p   
>For information on syntax, see <a   href="#src-85926043_id-.CertificateFieldValidatorsv7.4.0-BlacklistFileSyntax">Blacklist File Syntax</a>. Depending on your configuration, there may be a file size limit. With a limit of 1 MB, you will be able to put around 50 000 domains in your blacklist. To work around this limit, you can split the blacklist and use several validators.</p>
            </td>
        </tr>
</tbody>        </table>
            </div>
    </div>
    <div class="section section-2" id="src-85926043_id-.CertificateFieldValidatorsv7.4.0-BlacklistFileSyntax">
        <h2 class="heading "><span>Blacklist File Syntax</span></h2>
<p   
>Blacklist text files contain one blacklisted domain per line:</p>
<ul class=" "><li class=" "><p   
>IDN domains must be Punycode encoded</p>
</li><li class=" "><p   
>Empty lines are ignored</p>
</li><li class=" "><p   
>Leading and trailing whitespace is ignored</p>
</li><li class=" "><p   
>Text after a # is considered a comment and is ignored.</p>
</li><li class=" "><p   
>Comments may contain ASCII or UTF-8 text, but the file may not contain a byte order mark (BOM). If in doubt, save the file in plain ASCII format.</p>
</li></ul><p   
>The following shows an example of a blacklist text file:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                    <div class="title">sample_blacklist.txt</div>
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-title="sample_blacklist.txt" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="comments"># Sample blacklist file. Created 2019-03-01</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">bank        </code><code class="comments"># If domain component blocking is enabled, then this will block "bank.com", "bank.example.com" but NOT "memorybank.com"</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">example.com </code><code class="comments"># With base domain blocking one can block a domain including subdomains.</code></div>
<div class="line"><code class="plain">net         </code><code class="comments"># ...or entire TLDs (Top Level Domains)</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">evil.example.edu           </code><code class="comments"># It is possible to block a specific subdomain only</code></div>
<div class="line"><code class="plain">xn--rvare-jua.example.com  </code><code class="comments"># This is an IDN domain "rövare.example.com"</code></div>
</div>
    </div>
    </div>
    </div>
        </div>

    </article>


            <nav id="ht-post-nav">
                <a href="Key_Validators.html" class="ht-post-nav-prev">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-prev" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Key Validators</span>
        </a>
                <a href="Post_Processing_Validators.html" class="ht-post-nav-next">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-next" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Post Processing Validators</span>
        </a>
    </nav>    
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>
</body>
</html>
